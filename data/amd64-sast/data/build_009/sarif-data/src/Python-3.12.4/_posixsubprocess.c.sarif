{"$schema": "https://raw.githubusercontent.com/oasis-tcs/sarif-spec/master/Schemata/sarif-schema-2.1.0.json", "version": "2.1.0", "runs": [{"tool": {"driver": {"name": "GNU C11", "fullName": "GNU C11 (Ubuntu 13.2.0-23ubuntu4) version 13.2.0 (x86_64-linux-gnu)", "version": "13.2.0", "informationUri": "https://gcc.gnu.org/gcc-13/", "rules": [{"id": "-Wanalyzer-fd-leak", "helpUri": "https://gcc.gnu.org/onlinedocs/gcc/Static-Analyzer-Options.html#index-Wanalyzer-fd-leak"}]}}, "taxonomies": [{"name": "CWE", "version": "4.7", "organization": "MITRE", "shortDescription": {"text": "The MITRE Common Weakness Enumeration"}, "taxa": [{"id": "775", "helpUri": "https://cwe.mitre.org/data/definitions/775.html"}]}], "invocations": [{"executionSuccessful": true, "toolExecutionNotifications": []}], "originalUriBaseIds": {"PWD": {"uri": "file:///src/Python-3.12.4/"}}, "artifacts": [{"location": {"uri": "./Modules/_posixsubprocess.c", "uriBaseId": "PWD"}, "contents": {"text": "/* Authors: Gregory P. Smith & Jeffrey Yasskin */\n#ifndef Py_BUILD_CORE_BUILTIN\n#  define Py_BUILD_CORE_MODULE 1\n#endif\n\n#include \"Python.h\"\n#include \"pycore_fileutils.h\"\n#include \"pycore_pystate.h\"\n#if defined(HAVE_PIPE2) && !defined(_GNU_SOURCE)\n# define _GNU_SOURCE\n#endif\n#include <unistd.h>\n#include <fcntl.h>\n#ifdef HAVE_SYS_TYPES_H\n#include <sys/types.h>\n#endif\n#if defined(HAVE_SYS_STAT_H)\n#include <sys/stat.h>\n#endif\n#ifdef HAVE_SYS_SYSCALL_H\n#include <sys/syscall.h>\n#endif\n#if defined(HAVE_SYS_RESOURCE_H)\n#include <sys/resource.h>\n#endif\n#ifdef HAVE_DIRENT_H\n#include <dirent.h>\n#endif\n#ifdef HAVE_GRP_H\n#include <grp.h>\n#endif /* HAVE_GRP_H */\n\n#include \"posixmodule.h\"\n\n#ifdef _Py_MEMORY_SANITIZER\n# include <sanitizer/msan_interface.h>\n#endif\n\n#if defined(__ANDROID__) && __ANDROID_API__ < 21 && !defined(SYS_getdents64)\n# include <sys/linux-syscalls.h>\n# define SYS_getdents64  __NR_getdents64\n#endif\n\n#if defined(__linux__) && defined(HAVE_VFORK) && defined(HAVE_SIGNAL_H) && \\\n    defined(HAVE_PTHREAD_SIGMASK) && !defined(HAVE_BROKEN_PTHREAD_SIGMASK)\n/* If this is ever expanded to non-Linux platforms, verify what calls are\n * allowed after vfork(). Ex: setsid() may be disallowed on macOS? */\n# include <signal.h>\n# define VFORK_USABLE 1\n#endif\n\n#if defined(__sun) && defined(__SVR4)\n/* readdir64 is used to work around Solaris 9 bug 6395699. */\n# define readdir readdir64\n# define dirent dirent64\n# if !defined(HAVE_DIRFD)\n/* Some versions of Solaris lack dirfd(). */\n#  define dirfd(dirp) ((dirp)->dd_fd)\n#  define HAVE_DIRFD\n# endif\n#endif\n\n#if defined(__FreeBSD__) || (defined(__APPLE__) && defined(__MACH__)) || defined(__DragonFly__)\n# define FD_DIR \"/dev/fd\"\n#else\n# define FD_DIR \"/proc/self/fd\"\n#endif\n\n#ifdef NGROUPS_MAX\n#define MAX_GROUPS NGROUPS_MAX\n#else\n#define MAX_GROUPS 64\n#endif\n\n#define POSIX_CALL(call)   do { if ((call) == -1) goto error; } while (0)\n\nstatic struct PyModuleDef _posixsubprocessmodule;\n\n/*[clinic input]\nmodule _posixsubprocess\n[clinic start generated code]*/\n/*[clinic end generated code: output=da39a3ee5e6b4b0d input=c62211df27cf7334]*/\n\n/*[python input]\nclass pid_t_converter(CConverter):\n    type = 'pid_t'\n    format_unit = '\" _Py_PARSE_PID \"'\n\n    def parse_arg(self, argname, displayname):\n        return \"\"\"\n            {paramname} = PyLong_AsPid({argname});\n            if ({paramname} == -1 && PyErr_Occurred()) {{{{\n                goto exit;\n            }}}}\n            \"\"\".format(argname=argname, paramname=self.parser_name)\n[python start generated code]*/\n/*[python end generated code: output=da39a3ee5e6b4b0d input=5af1c116d56cbb5a]*/\n\n#include \"clinic/_posixsubprocess.c.h\"\n\n/* Convert ASCII to a positive int, no libc call. no overflow. -1 on error. */\nstatic int\n_pos_int_from_ascii(const char *name)\n{\n    int num = 0;\n    while (*name >= '0' && *name <= '9') {\n        num = num * 10 + (*name - '0');\n        ++name;\n    }\n    if (*name)\n        return -1;  /* Non digit found, not a number. */\n    return num;\n}\n\n\n#if defined(__FreeBSD__) || defined(__DragonFly__)\n/* When /dev/fd isn't mounted it is often a static directory populated\n * with 0 1 2 or entries for 0 .. 63 on FreeBSD, NetBSD, OpenBSD and DragonFlyBSD.\n * NetBSD and OpenBSD have a /proc fs available (though not necessarily\n * mounted) and do not have fdescfs for /dev/fd.  MacOS X has a devfs\n * that properly supports /dev/fd.\n */\nstatic int\n_is_fdescfs_mounted_on_dev_fd(void)\n{\n    struct stat dev_stat;\n    struct stat dev_fd_stat;\n    if (stat(\"/dev\", &dev_stat) != 0)\n        return 0;\n    if (stat(FD_DIR, &dev_fd_stat) != 0)\n        return 0;\n    if (dev_stat.st_dev == dev_fd_stat.st_dev)\n        return 0;  /* / == /dev == /dev/fd means it is static. #fail */\n    return 1;\n}\n#endif\n\n\n/* Returns 1 if there is a problem with fd_sequence, 0 otherwise. */\nstatic int\n_sanity_check_python_fd_sequence(PyObject *fd_sequence)\n{\n    Py_ssize_t seq_idx;\n    long prev_fd = -1;\n    for (seq_idx = 0; seq_idx < PyTuple_GET_SIZE(fd_sequence); ++seq_idx) {\n        PyObject* py_fd = PyTuple_GET_ITEM(fd_sequence, seq_idx);\n        long iter_fd;\n        if (!PyLong_Check(py_fd)) {\n            return 1;\n        }\n        iter_fd = PyLong_AsLong(py_fd);\n        if (iter_fd < 0 || iter_fd <= prev_fd || iter_fd > INT_MAX) {\n            /* Negative, overflow, unsorted, too big for a fd. */\n            return 1;\n        }\n        prev_fd = iter_fd;\n    }\n    return 0;\n}\n\n\n/* Is fd found in the sorted Python Sequence? */\nstatic int\n_is_fd_in_sorted_fd_sequence(int fd, int *fd_sequence,\n                             Py_ssize_t fd_sequence_len)\n{\n    /* Binary search. */\n    Py_ssize_t search_min = 0;\n    Py_ssize_t search_max = fd_sequence_len - 1;\n    if (search_max < 0)\n        return 0;\n    do {\n        long middle = (search_min + search_max) / 2;\n        long middle_fd = fd_sequence[middle];\n        if (fd == middle_fd)\n            return 1;\n        if (fd > middle_fd)\n            search_min = middle + 1;\n        else\n            search_max = middle - 1;\n    } while (search_min <= search_max);\n    return 0;\n}\n\n/*\n * Do all the Python C API calls in the parent process to turn the pass_fds\n * \"py_fds_to_keep\" tuple into a C array.  The caller owns allocation and\n * freeing of the array.\n *\n * On error an unknown number of array elements may have been filled in.\n * A Python exception has been set when an error is returned.\n *\n * Returns: -1 on error, 0 on success.\n */\nstatic int\nconvert_fds_to_keep_to_c(PyObject *py_fds_to_keep, int *c_fds_to_keep)\n{\n    Py_ssize_t i, len;\n\n    len = PyTuple_GET_SIZE(py_fds_to_keep);\n    for (i = 0; i < len; ++i) {\n        PyObject* fdobj = PyTuple_GET_ITEM(py_fds_to_keep, i);\n        long fd = PyLong_AsLong(fdobj);\n        if (fd == -1 && PyErr_Occurred()) {\n            return -1;\n        }\n        if (fd < 0 || fd > INT_MAX) {\n            PyErr_SetString(PyExc_ValueError,\n                            \"fd out of range in fds_to_keep.\");\n            return -1;\n        }\n        c_fds_to_keep[i] = (int)fd;\n    }\n    return 0;\n}\n\n\n/* This function must be async-signal-safe as it is called from child_exec()\n * after fork() or vfork().\n */\nstatic int\nmake_inheritable(int *c_fds_to_keep, Py_ssize_t len, int errpipe_write)\n{\n    Py_ssize_t i;\n\n    for (i = 0; i < len; ++i) {\n        int fd = c_fds_to_keep[i];\n        if (fd == errpipe_write) {\n            /* errpipe_write is part of fds_to_keep. It must be closed at\n               exec(), but kept open in the child process until exec() is\n               called. */\n            continue;\n        }\n        if (_Py_set_inheritable_async_safe(fd, 1, NULL) < 0)\n            return -1;\n    }\n    return 0;\n}\n\n\n/* Get the maximum file descriptor that could be opened by this process.\n * This function is async signal safe for use between fork() and exec().\n */\nstatic long\nsafe_get_max_fd(void)\n{\n    long local_max_fd;\n#if defined(__NetBSD__)\n    local_max_fd = fcntl(0, F_MAXFD);\n    if (local_max_fd >= 0)\n        return local_max_fd;\n#endif\n#if defined(HAVE_SYS_RESOURCE_H) && defined(__OpenBSD__)\n    struct rlimit rl;\n    /* Not on the POSIX async signal safe functions list but likely\n     * safe.  TODO - Someone should audit OpenBSD to make sure. */\n    if (getrlimit(RLIMIT_NOFILE, &rl) >= 0)\n        return (long) rl.rlim_max;\n#endif\n#ifdef _SC_OPEN_MAX\n    local_max_fd = sysconf(_SC_OPEN_MAX);\n    if (local_max_fd == -1)\n#endif\n        local_max_fd = 256;  /* Matches legacy Lib/subprocess.py behavior. */\n    return local_max_fd;\n}\n\n\n/* Close all file descriptors in the given range except for those in\n * fds_to_keep by invoking closer on each subrange.\n *\n * If end_fd == -1, it's guessed via safe_get_max_fd(), but it isn't\n * possible to know for sure what the max fd to go up to is for\n * processes with the capability of raising their maximum, or in case\n * a process opened a high fd and then lowered its maximum.\n */\nstatic int\n_close_range_except(int start_fd,\n                    int end_fd,\n                    int *fds_to_keep,\n                    Py_ssize_t fds_to_keep_len,\n                    int (*closer)(int, int))\n{\n    if (end_fd == -1) {\n        end_fd = Py_MIN(safe_get_max_fd(), INT_MAX);\n    }\n    Py_ssize_t keep_seq_idx;\n    /* As fds_to_keep is sorted we can loop through the list closing\n     * fds in between any in the keep list falling within our range. */\n    for (keep_seq_idx = 0; keep_seq_idx < fds_to_keep_len; ++keep_seq_idx) {\n        int keep_fd = fds_to_keep[keep_seq_idx];\n        if (keep_fd < start_fd)\n            continue;\n        if (closer(start_fd, keep_fd - 1) != 0)\n            return -1;\n        start_fd = keep_fd + 1;\n    }\n    if (start_fd <= end_fd) {\n        if (closer(start_fd, end_fd) != 0)\n            return -1;\n    }\n    return 0;\n}\n\n#if defined(__linux__) && defined(HAVE_SYS_SYSCALL_H)\n/* It doesn't matter if d_name has room for NAME_MAX chars; we're using this\n * only to read a directory of short file descriptor number names.  The kernel\n * will return an error if we didn't give it enough space.  Highly Unlikely.\n * This structure is very old and stable: It will not change unless the kernel\n * chooses to break compatibility with all existing binaries.  Highly Unlikely.\n */\nstruct linux_dirent64 {\n   unsigned long long d_ino;\n   long long d_off;\n   unsigned short d_reclen;     /* Length of this linux_dirent */\n   unsigned char  d_type;\n   char           d_name[256];  /* Filename (null-terminated) */\n};\n\nstatic int\n_brute_force_closer(int first, int last)\n{\n    for (int i = first; i <= last; i++) {\n        /* Ignore errors */\n        (void)close(i);\n    }\n    return 0;\n}\n\n/* Close all open file descriptors in the range from start_fd and higher\n * Do not close any in the sorted fds_to_keep list.\n *\n * This version is async signal safe as it does not make any unsafe C library\n * calls, malloc calls or handle any locks.  It is _unfortunate_ to be forced\n * to resort to making a kernel system call directly but this is the ONLY api\n * available that does no harm.  opendir/readdir/closedir perform memory\n * allocation and locking so while they usually work they are not guaranteed\n * to (especially if you have replaced your malloc implementation).  A version\n * of this function that uses those can be found in the _maybe_unsafe variant.\n *\n * This is Linux specific because that is all I am ready to test it on.  It\n * should be easy to add OS specific dirent or dirent64 structures and modify\n * it with some cpp #define magic to work on other OSes as well if you want.\n */\nstatic void\n_close_open_fds_safe(int start_fd, int *fds_to_keep, Py_ssize_t fds_to_keep_len)\n{\n    int fd_dir_fd;\n\n    fd_dir_fd = _Py_open_noraise(FD_DIR, O_RDONLY);\n    if (fd_dir_fd == -1) {\n        /* No way to get a list of open fds. */\n        _close_range_except(start_fd, -1,\n                            fds_to_keep, fds_to_keep_len,\n                            _brute_force_closer);\n        return;\n    } else {\n        char buffer[sizeof(struct linux_dirent64)];\n        int bytes;\n        while ((bytes = syscall(SYS_getdents64, fd_dir_fd,\n                                (struct linux_dirent64 *)buffer,\n                                sizeof(buffer))) > 0) {\n            struct linux_dirent64 *entry;\n            int offset;\n#ifdef _Py_MEMORY_SANITIZER\n            __msan_unpoison(buffer, bytes);\n#endif\n            for (offset = 0; offset < bytes; offset += entry->d_reclen) {\n                int fd;\n                entry = (struct linux_dirent64 *)(buffer + offset);\n                if ((fd = _pos_int_from_ascii(entry->d_name)) < 0)\n                    continue;  /* Not a number. */\n                if (fd != fd_dir_fd && fd >= start_fd &&\n                    !_is_fd_in_sorted_fd_sequence(fd, fds_to_keep,\n                                                  fds_to_keep_len)) {\n                    close(fd);\n                }\n            }\n        }\n        close(fd_dir_fd);\n    }\n}\n\n#define _close_open_fds_fallback _close_open_fds_safe\n\n#else  /* NOT (defined(__linux__) && defined(HAVE_SYS_SYSCALL_H)) */\n\nstatic int\n_unsafe_closer(int first, int last)\n{\n    _Py_closerange(first, last);\n    return 0;\n}\n\n/* Close all open file descriptors from start_fd and higher.\n * Do not close any in the sorted fds_to_keep tuple.\n *\n * This function violates the strict use of async signal safe functions. :(\n * It calls opendir(), readdir() and closedir().  Of these, the one most\n * likely to ever cause a problem is opendir() as it performs an internal\n * malloc().  Practically this should not be a problem.  The Java VM makes the\n * same calls between fork and exec in its own UNIXProcess_md.c implementation.\n *\n * readdir_r() is not used because it provides no benefit.  It is typically\n * implemented as readdir() followed by memcpy().  See also:\n *   http://womble.decadent.org.uk/readdir_r-advisory.html\n */\nstatic void\n_close_open_fds_maybe_unsafe(int start_fd, int *fds_to_keep,\n                             Py_ssize_t fds_to_keep_len)\n{\n    DIR *proc_fd_dir;\n#ifndef HAVE_DIRFD\n    while (_is_fd_in_sorted_fd_sequence(start_fd, fds_to_keep,\n                                        fds_to_keep_len)) {\n        ++start_fd;\n    }\n    /* Close our lowest fd before we call opendir so that it is likely to\n     * reuse that fd otherwise we might close opendir's file descriptor in\n     * our loop.  This trick assumes that fd's are allocated on a lowest\n     * available basis. */\n    close(start_fd);\n    ++start_fd;\n#endif\n\n#if defined(__FreeBSD__) || defined(__DragonFly__)\n    if (!_is_fdescfs_mounted_on_dev_fd())\n        proc_fd_dir = NULL;\n    else\n#endif\n        proc_fd_dir = opendir(FD_DIR);\n    if (!proc_fd_dir) {\n        /* No way to get a list of open fds. */\n        _close_range_except(start_fd, -1, fds_to_keep, fds_to_keep_len,\n                            _unsafe_closer);\n    } else {\n        struct dirent *dir_entry;\n#ifdef HAVE_DIRFD\n        int fd_used_by_opendir = dirfd(proc_fd_dir);\n#else\n        int fd_used_by_opendir = start_fd - 1;\n#endif\n        errno = 0;\n        while ((dir_entry = readdir(proc_fd_dir))) {\n            int fd;\n            if ((fd = _pos_int_from_ascii(dir_entry->d_name)) < 0)\n                continue;  /* Not a number. */\n            if (fd != fd_used_by_opendir && fd >= start_fd &&\n                !_is_fd_in_sorted_fd_sequence(fd, fds_to_keep,\n                                              fds_to_keep_len)) {\n                close(fd);\n            }\n            errno = 0;\n        }\n        if (errno) {\n            /* readdir error, revert behavior. Highly Unlikely. */\n            _close_range_except(start_fd, -1, fds_to_keep, fds_to_keep_len,\n                                _unsafe_closer);\n        }\n        closedir(proc_fd_dir);\n    }\n}\n\n#define _close_open_fds_fallback _close_open_fds_maybe_unsafe\n\n#endif  /* else NOT (defined(__linux__) && defined(HAVE_SYS_SYSCALL_H)) */\n\n/* We can use close_range() library function only if it's known to be\n * async-signal-safe.\n *\n * On Linux, glibc explicitly documents it to be a thin wrapper over\n * the system call, and other C libraries are likely to follow glibc.\n */\n#if defined(HAVE_CLOSE_RANGE) && \\\n    (defined(__linux__) || defined(__FreeBSD__))\n#define HAVE_ASYNC_SAFE_CLOSE_RANGE\n\nstatic int\n_close_range_closer(int first, int last)\n{\n    return close_range(first, last, 0);\n}\n#endif\n\nstatic void\n_close_open_fds(int start_fd, int *fds_to_keep, Py_ssize_t fds_to_keep_len)\n{\n#ifdef HAVE_ASYNC_SAFE_CLOSE_RANGE\n    if (_close_range_except(\n            start_fd, INT_MAX, fds_to_keep, fds_to_keep_len,\n            _close_range_closer) == 0) {\n        return;\n    }\n#endif\n    _close_open_fds_fallback(start_fd, fds_to_keep, fds_to_keep_len);\n}\n\n#ifdef VFORK_USABLE\n/* Reset dispositions for all signals to SIG_DFL except for ignored\n * signals. This way we ensure that no signal handlers can run\n * after we unblock signals in a child created by vfork().\n */\nstatic void\nreset_signal_handlers(const sigset_t *child_sigmask)\n{\n    struct sigaction sa_dfl = {.sa_handler = SIG_DFL};\n    for (int sig = 1; sig < _NSIG; sig++) {\n        /* Dispositions for SIGKILL and SIGSTOP can't be changed. */\n        if (sig == SIGKILL || sig == SIGSTOP) {\n            continue;\n        }\n\n        /* There is no need to reset the disposition of signals that will\n         * remain blocked across execve() since the kernel will do it. */\n        if (sigismember(child_sigmask, sig) == 1) {\n            continue;\n        }\n\n        struct sigaction sa;\n        /* C libraries usually return EINVAL for signals used\n         * internally (e.g. for thread cancellation), so simply\n         * skip errors here. */\n        if (sigaction(sig, NULL, &sa) == -1) {\n            continue;\n        }\n\n        /* void *h works as these fields are both pointer types already. */\n        void *h = (sa.sa_flags & SA_SIGINFO ? (void *)sa.sa_sigaction :\n                                              (void *)sa.sa_handler);\n        if (h == SIG_IGN || h == SIG_DFL) {\n            continue;\n        }\n\n        /* This call can't reasonably fail, but if it does, terminating\n         * the child seems to be too harsh, so ignore errors. */\n        (void) sigaction(sig, &sa_dfl, NULL);\n    }\n}\n#endif /* VFORK_USABLE */\n\n\n/*\n * This function is code executed in the child process immediately after\n * (v)fork to set things up and call exec().\n *\n * All of the code in this function must only use async-signal-safe functions,\n * listed at `man 7 signal` or\n * http://www.opengroup.org/onlinepubs/009695399/functions/xsh_chap02_04.html.\n *\n * This restriction is documented at\n * http://www.opengroup.org/onlinepubs/009695399/functions/fork.html.\n *\n * If this function is called after vfork(), even more care must be taken.\n * The lack of preparations that C libraries normally take on fork(),\n * as well as sharing the address space with the parent, might make even\n * async-signal-safe functions vfork-unsafe. In particular, on Linux,\n * set*id() and setgroups() library functions must not be called, since\n * they have to interact with the library-level thread list and send\n * library-internal signals to implement per-process credentials semantics\n * required by POSIX but not supported natively on Linux. Another reason to\n * avoid this family of functions is that sharing an address space between\n * processes running with different privileges is inherently insecure.\n * See https://bugs.python.org/issue35823 for discussion and references.\n *\n * In some C libraries, setrlimit() has the same thread list/signalling\n * behavior since resource limits were per-thread attributes before\n * Linux 2.6.10. Musl, as of 1.2.1, is known to have this issue\n * (https://www.openwall.com/lists/musl/2020/10/15/6).\n *\n * If vfork-unsafe functionality is desired after vfork(), consider using\n * syscall() to obtain it.\n */\nPy_NO_INLINE static void\nchild_exec(char *const exec_array[],\n           char *const argv[],\n           char *const envp[],\n           const char *cwd,\n           int p2cread, int p2cwrite,\n           int c2pread, int c2pwrite,\n           int errread, int errwrite,\n           int errpipe_read, int errpipe_write,\n           int close_fds, int restore_signals,\n           int call_setsid, pid_t pgid_to_set,\n           gid_t gid,\n           Py_ssize_t extra_group_size, const gid_t *extra_groups,\n           uid_t uid, int child_umask,\n           const void *child_sigmask,\n           int *fds_to_keep, Py_ssize_t fds_to_keep_len,\n           PyObject *preexec_fn,\n           PyObject *preexec_fn_args_tuple)\n{\n    int i, saved_errno;\n    PyObject *result;\n    /* Indicate to the parent that the error happened before exec(). */\n    const char *err_msg = \"noexec\";\n    /* Buffer large enough to hold a hex integer.  We can't malloc. */\n    char hex_errno[sizeof(saved_errno)*2+1];\n\n    if (make_inheritable(fds_to_keep, fds_to_keep_len, errpipe_write) < 0)\n        goto error;\n\n    /* Close parent's pipe ends. */\n    if (p2cwrite != -1)\n        POSIX_CALL(close(p2cwrite));\n    if (c2pread != -1)\n        POSIX_CALL(close(c2pread));\n    if (errread != -1)\n        POSIX_CALL(close(errread));\n    POSIX_CALL(close(errpipe_read));\n\n    /* When duping fds, if there arises a situation where one of the fds is\n       either 0, 1 or 2, it is possible that it is overwritten (#12607). */\n    if (c2pwrite == 0) {\n        POSIX_CALL(c2pwrite = dup(c2pwrite));\n        /* issue32270 */\n        if (_Py_set_inheritable_async_safe(c2pwrite, 0, NULL) < 0) {\n            goto error;\n        }\n    }\n    while (errwrite == 0 || errwrite == 1) {\n        POSIX_CALL(errwrite = dup(errwrite));\n        /* issue32270 */\n        if (_Py_set_inheritable_async_safe(errwrite, 0, NULL) < 0) {\n            goto error;\n        }\n    }\n\n    /* Dup fds for child.\n       dup2() removes the CLOEXEC flag but we must do it ourselves if dup2()\n       would be a no-op (issue #10806). */\n    if (p2cread == 0) {\n        if (_Py_set_inheritable_async_safe(p2cread, 1, NULL) < 0)\n            goto error;\n    }\n    else if (p2cread != -1)\n        POSIX_CALL(dup2(p2cread, 0));  /* stdin */\n\n    if (c2pwrite == 1) {\n        if (_Py_set_inheritable_async_safe(c2pwrite, 1, NULL) < 0)\n            goto error;\n    }\n    else if (c2pwrite != -1)\n        POSIX_CALL(dup2(c2pwrite, 1));  /* stdout */\n\n    if (errwrite == 2) {\n        if (_Py_set_inheritable_async_safe(errwrite, 1, NULL) < 0)\n            goto error;\n    }\n    else if (errwrite != -1)\n        POSIX_CALL(dup2(errwrite, 2));  /* stderr */\n\n    /* We no longer manually close p2cread, c2pwrite, and errwrite here as\n     * _close_open_fds takes care when it is not already non-inheritable. */\n\n    if (cwd) {\n        if (chdir(cwd) == -1) {\n            err_msg = \"noexec:chdir\";\n            goto error;\n        }\n    }\n\n    if (child_umask >= 0)\n        umask(child_umask);  /* umask() always succeeds. */\n\n    if (restore_signals)\n        _Py_RestoreSignals();\n\n#ifdef VFORK_USABLE\n    if (child_sigmask) {\n        reset_signal_handlers(child_sigmask);\n        if ((errno = pthread_sigmask(SIG_SETMASK, child_sigmask, NULL))) {\n            goto error;\n        }\n    }\n#endif\n\n#ifdef HAVE_SETSID\n    if (call_setsid)\n        POSIX_CALL(setsid());\n#endif\n\n#ifdef HAVE_SETPGID\n    static_assert(_Py_IS_TYPE_SIGNED(pid_t), \"pid_t is unsigned\");\n    if (pgid_to_set >= 0) {\n        POSIX_CALL(setpgid(0, pgid_to_set));\n    }\n#endif\n\n#ifdef HAVE_SETGROUPS\n    if (extra_group_size >= 0) {\n        assert((extra_group_size == 0) == (extra_groups == NULL));\n        POSIX_CALL(setgroups(extra_group_size, extra_groups));\n    }\n#endif /* HAVE_SETGROUPS */\n\n#ifdef HAVE_SETREGID\n    if (gid != (gid_t)-1)\n        POSIX_CALL(setregid(gid, gid));\n#endif /* HAVE_SETREGID */\n\n#ifdef HAVE_SETREUID\n    if (uid != (uid_t)-1)\n        POSIX_CALL(setreuid(uid, uid));\n#endif /* HAVE_SETREUID */\n\n\n    err_msg = \"\";\n    if (preexec_fn != Py_None && preexec_fn_args_tuple) {\n        /* This is where the user has asked us to deadlock their program. */\n        result = PyObject_Call(preexec_fn, preexec_fn_args_tuple, NULL);\n        if (result == NULL) {\n            /* Stringifying the exception or traceback would involve\n             * memory allocation and thus potential for deadlock.\n             * We've already faced potential deadlock by calling back\n             * into Python in the first place, so it probably doesn't\n             * matter but we avoid it to minimize the possibility. */\n            err_msg = \"Exception occurred in preexec_fn.\";\n            errno = 0;  /* We don't want to report an OSError. */\n            goto error;\n        }\n        /* Py_DECREF(result); - We're about to exec so why bother? */\n    }\n\n    /* close FDs after executing preexec_fn, which might open FDs */\n    if (close_fds) {\n        /* TODO HP-UX could use pstat_getproc() if anyone cares about it. */\n        _close_open_fds(3, fds_to_keep, fds_to_keep_len);\n    }\n\n    /* This loop matches the Lib/os.py _execvpe()'s PATH search when */\n    /* given the executable_list generated by Lib/subprocess.py.     */\n    saved_errno = 0;\n    for (i = 0; exec_array[i] != NULL; ++i) {\n        const char *executable = exec_array[i];\n        if (envp) {\n            execve(executable, argv, envp);\n        } else {\n            execv(executable, argv);\n        }\n        if (errno != ENOENT && errno != ENOTDIR && saved_errno == 0) {\n            saved_errno = errno;\n        }\n    }\n    /* Report the first exec error, not the last. */\n    if (saved_errno)\n        errno = saved_errno;\n\nerror:\n    saved_errno = errno;\n    /* Report the posix error to our parent process. */\n    /* We ignore all write() return values as the total size of our writes is\n       less than PIPEBUF and we cannot do anything about an error anyways.\n       Use _Py_write_noraise() to retry write() if it is interrupted by a\n       signal (fails with EINTR). */\n    if (saved_errno) {\n        char *cur;\n        _Py_write_noraise(errpipe_write, \"OSError:\", 8);\n        cur = hex_errno + sizeof(hex_errno);\n        while (saved_errno != 0 && cur != hex_errno) {\n            *--cur = Py_hexdigits[saved_errno % 16];\n            saved_errno /= 16;\n        }\n        _Py_write_noraise(errpipe_write, cur, hex_errno + sizeof(hex_errno) - cur);\n        _Py_write_noraise(errpipe_write, \":\", 1);\n        /* We can't call strerror(saved_errno).  It is not async signal safe.\n         * The parent process will look the error message up. */\n    } else {\n        _Py_write_noraise(errpipe_write, \"SubprocessError:0:\", 18);\n    }\n    _Py_write_noraise(errpipe_write, err_msg, strlen(err_msg));\n}\n\n\n/* The main purpose of this wrapper function is to isolate vfork() from both\n * subprocess_fork_exec() and child_exec(). A child process created via\n * vfork() executes on the same stack as the parent process while the latter is\n * suspended, so this function should not be inlined to avoid compiler bugs\n * that might clobber data needed by the parent later. Additionally,\n * child_exec() should not be inlined to avoid spurious -Wclobber warnings from\n * GCC (see bpo-35823).\n */\nPy_NO_INLINE static pid_t\ndo_fork_exec(char *const exec_array[],\n             char *const argv[],\n             char *const envp[],\n             const char *cwd,\n             int p2cread, int p2cwrite,\n             int c2pread, int c2pwrite,\n             int errread, int errwrite,\n             int errpipe_read, int errpipe_write,\n             int close_fds, int restore_signals,\n             int call_setsid, pid_t pgid_to_set,\n             gid_t gid,\n             Py_ssize_t extra_group_size, const gid_t *extra_groups,\n             uid_t uid, int child_umask,\n             const void *child_sigmask,\n             int *fds_to_keep, Py_ssize_t fds_to_keep_len,\n             PyObject *preexec_fn,\n             PyObject *preexec_fn_args_tuple)\n{\n\n    pid_t pid;\n\n#ifdef VFORK_USABLE\n    PyThreadState *vfork_tstate_save;\n    if (child_sigmask) {\n        /* These are checked by our caller; verify them in debug builds. */\n        assert(uid == (uid_t)-1);\n        assert(gid == (gid_t)-1);\n        assert(extra_group_size < 0);\n        assert(preexec_fn == Py_None);\n\n        /* Drop the GIL so that other threads can continue execution while this\n         * thread in the parent remains blocked per vfork-semantics on the\n         * child's exec syscall outcome. Exec does filesystem access which\n         * can take an arbitrarily long time. This addresses GH-104372.\n         *\n         * The vfork'ed child still runs in our address space. Per POSIX it\n         * must be limited to nothing but exec, but the Linux implementation\n         * is a little more usable. See the child_exec() comment - The child\n         * MUST NOT re-acquire the GIL.\n         */\n        vfork_tstate_save = PyEval_SaveThread();\n        pid = vfork();\n        if (pid != 0) {\n            // Not in the child process, reacquire the GIL.\n            PyEval_RestoreThread(vfork_tstate_save);\n        }\n        if (pid == (pid_t)-1) {\n            /* If vfork() fails, fall back to using fork(). When it isn't\n             * allowed in a process by the kernel, vfork can return -1\n             * with errno EINVAL. https://bugs.python.org/issue47151. */\n            pid = fork();\n        }\n    } else\n#endif\n    {\n        pid = fork();\n    }\n\n    if (pid != 0) {\n        // Parent process.\n        return pid;\n    }\n\n    /* Child process.\n     * See the comment above child_exec() for restrictions imposed on\n     * the code below.\n     */\n\n    if (preexec_fn != Py_None) {\n        /* We'll be calling back into Python later so we need to do this.\n         * This call may not be async-signal-safe but neither is calling\n         * back into Python.  The user asked us to use hope as a strategy\n         * to avoid deadlock... */\n        PyOS_AfterFork_Child();\n    }\n\n    child_exec(exec_array, argv, envp, cwd,\n               p2cread, p2cwrite, c2pread, c2pwrite,\n               errread, errwrite, errpipe_read, errpipe_write,\n               close_fds, restore_signals, call_setsid, pgid_to_set,\n               gid, extra_group_size, extra_groups,\n               uid, child_umask, child_sigmask,\n               fds_to_keep, fds_to_keep_len,\n               preexec_fn, preexec_fn_args_tuple);\n    _exit(255);\n    return 0;  /* Dead code to avoid a potential compiler warning. */\n}\n\n/*[clinic input]\n_posixsubprocess.fork_exec as subprocess_fork_exec\n    args as process_args: object\n    executable_list: object\n    close_fds: bool\n    pass_fds as py_fds_to_keep: object(subclass_of='&PyTuple_Type')\n    cwd as cwd_obj: object\n    env as env_list: object\n    p2cread: int\n    p2cwrite: int\n    c2pread: int\n    c2pwrite: int\n    errread: int\n    errwrite: int\n    errpipe_read: int\n    errpipe_write: int\n    restore_signals: bool\n    call_setsid: bool\n    pgid_to_set: pid_t\n    gid as gid_object: object\n    extra_groups as extra_groups_packed: object\n    uid as uid_object: object\n    child_umask: int\n    preexec_fn: object\n    allow_vfork: bool\n    /\n\nSpawn a fresh new child process.\n\nFork a child process, close parent file descriptors as appropriate in the\nchild and duplicate the few that are needed before calling exec() in the\nchild process.\n\nIf close_fds is True, close file descriptors 3 and higher, except those listed\nin the sorted tuple pass_fds.\n\nThe preexec_fn, if supplied, will be called immediately before closing file\ndescriptors and exec.\n\nWARNING: preexec_fn is NOT SAFE if your application uses threads.\n         It may trigger infrequent, difficult to debug deadlocks.\n\nIf an error occurs in the child process before the exec, it is\nserialized and written to the errpipe_write fd per subprocess.py.\n\nReturns: the child process's PID.\n\nRaises: Only on an error in the parent process.\n[clinic start generated code]*/\n\nstatic PyObject *\nsubprocess_fork_exec_impl(PyObject *module, PyObject *process_args,\n                          PyObject *executable_list, int close_fds,\n                          PyObject *py_fds_to_keep, PyObject *cwd_obj,\n                          PyObject *env_list, int p2cread, int p2cwrite,\n                          int c2pread, int c2pwrite, int errread,\n                          int errwrite, int errpipe_read, int errpipe_write,\n                          int restore_signals, int call_setsid,\n                          pid_t pgid_to_set, PyObject *gid_object,\n                          PyObject *extra_groups_packed,\n                          PyObject *uid_object, int child_umask,\n                          PyObject *preexec_fn, int allow_vfork)\n/*[clinic end generated code: output=7ee4f6ee5cf22b5b input=51757287ef266ffa]*/\n{\n    PyObject *converted_args = NULL, *fast_args = NULL;\n    PyObject *preexec_fn_args_tuple = NULL;\n    gid_t *extra_groups = NULL;\n    PyObject *cwd_obj2 = NULL;\n    const char *cwd = NULL;\n    pid_t pid = -1;\n    int need_to_reenable_gc = 0;\n    char *const *argv = NULL, *const *envp = NULL;\n    int need_after_fork = 0;\n    int saved_errno = 0;\n    int *c_fds_to_keep = NULL;\n    Py_ssize_t fds_to_keep_len = PyTuple_GET_SIZE(py_fds_to_keep);\n\n    PyInterpreterState *interp = PyInterpreterState_Get();\n    if ((preexec_fn != Py_None) &&\n        _PyInterpreterState_GetFinalizing(interp) != NULL)\n    {\n        PyErr_SetString(PyExc_RuntimeError,\n                        \"preexec_fn not supported at interpreter shutdown\");\n        return NULL;\n    }\n    if ((preexec_fn != Py_None) && (interp != PyInterpreterState_Main())) {\n        PyErr_SetString(PyExc_RuntimeError,\n                        \"preexec_fn not supported within subinterpreters\");\n        return NULL;\n    }\n\n    if (close_fds && errpipe_write < 3) {  /* precondition */\n        PyErr_SetString(PyExc_ValueError, \"errpipe_write must be >= 3\");\n        return NULL;\n    }\n    if (_sanity_check_python_fd_sequence(py_fds_to_keep)) {\n        PyErr_SetString(PyExc_ValueError, \"bad value(s) in fds_to_keep\");\n        return NULL;\n    }\n\n    /* We need to call gc.disable() when we'll be calling preexec_fn */\n    if (preexec_fn != Py_None) {\n        need_to_reenable_gc = PyGC_Disable();\n    }\n\n    char *const *exec_array = _PySequence_BytesToCharpArray(executable_list);\n    if (!exec_array)\n        goto cleanup;\n\n    /* Convert args and env into appropriate arguments for exec() */\n    /* These conversions are done in the parent process to avoid allocating\n       or freeing memory in the child process. */\n    if (process_args != Py_None) {\n        Py_ssize_t num_args;\n        /* Equivalent to:  */\n        /*  tuple(PyUnicode_FSConverter(arg) for arg in process_args)  */\n        fast_args = PySequence_Fast(process_args, \"argv must be a tuple\");\n        if (fast_args == NULL)\n            goto cleanup;\n        num_args = PySequence_Fast_GET_SIZE(fast_args);\n        converted_args = PyTuple_New(num_args);\n        if (converted_args == NULL)\n            goto cleanup;\n        for (Py_ssize_t arg_num = 0; arg_num < num_args; ++arg_num) {\n            PyObject *borrowed_arg, *converted_arg;\n            if (PySequence_Fast_GET_SIZE(fast_args) != num_args) {\n                PyErr_SetString(PyExc_RuntimeError, \"args changed during iteration\");\n                goto cleanup;\n            }\n            borrowed_arg = PySequence_Fast_GET_ITEM(fast_args, arg_num);\n            if (PyUnicode_FSConverter(borrowed_arg, &converted_arg) == 0)\n                goto cleanup;\n            PyTuple_SET_ITEM(converted_args, arg_num, converted_arg);\n        }\n\n        argv = _PySequence_BytesToCharpArray(converted_args);\n        Py_CLEAR(converted_args);\n        Py_CLEAR(fast_args);\n        if (!argv)\n            goto cleanup;\n    }\n\n    if (env_list != Py_None) {\n        envp = _PySequence_BytesToCharpArray(env_list);\n        if (!envp)\n            goto cleanup;\n    }\n\n    if (cwd_obj != Py_None) {\n        if (PyUnicode_FSConverter(cwd_obj, &cwd_obj2) == 0)\n            goto cleanup;\n        cwd = PyBytes_AsString(cwd_obj2);\n    }\n\n    // Special initial value meaning that subprocess API was called with\n    // extra_groups=None leading to _posixsubprocess.fork_exec(gids=None).\n    // We use this to differentiate between code desiring a setgroups(0, NULL)\n    // call vs no call at all.  The fast vfork() code path could be used when\n    // there is no setgroups call.\n    Py_ssize_t extra_group_size = -2;\n\n    if (extra_groups_packed != Py_None) {\n#ifdef HAVE_SETGROUPS\n        if (!PyList_Check(extra_groups_packed)) {\n            PyErr_SetString(PyExc_TypeError,\n                    \"setgroups argument must be a list\");\n            goto cleanup;\n        }\n        extra_group_size = PySequence_Size(extra_groups_packed);\n\n        if (extra_group_size < 0)\n            goto cleanup;\n\n        if (extra_group_size > MAX_GROUPS) {\n            PyErr_SetString(PyExc_ValueError, \"too many extra_groups\");\n            goto cleanup;\n        }\n\n        /* Deliberately keep extra_groups == NULL for extra_group_size == 0 */\n        if (extra_group_size > 0) {\n            extra_groups = PyMem_RawMalloc(extra_group_size * sizeof(gid_t));\n            if (extra_groups == NULL) {\n                PyErr_SetString(PyExc_MemoryError,\n                        \"failed to allocate memory for group list\");\n                goto cleanup;\n            }\n        }\n\n        for (Py_ssize_t i = 0; i < extra_group_size; i++) {\n            PyObject *elem;\n            elem = PySequence_GetItem(extra_groups_packed, i);\n            if (!elem)\n                goto cleanup;\n            if (!PyLong_Check(elem)) {\n                PyErr_SetString(PyExc_TypeError,\n                                \"extra_groups must be integers\");\n                Py_DECREF(elem);\n                goto cleanup;\n            } else {\n                gid_t gid;\n                if (!_Py_Gid_Converter(elem, &gid)) {\n                    Py_DECREF(elem);\n                    PyErr_SetString(PyExc_ValueError, \"invalid group id\");\n                    goto cleanup;\n                }\n                extra_groups[i] = gid;\n            }\n            Py_DECREF(elem);\n        }\n\n#else /* HAVE_SETGROUPS */\n        PyErr_BadInternalCall();\n        goto cleanup;\n#endif /* HAVE_SETGROUPS */\n    }\n\n    gid_t gid = (gid_t)-1;\n    if (gid_object != Py_None) {\n#ifdef HAVE_SETREGID\n        if (!_Py_Gid_Converter(gid_object, &gid))\n            goto cleanup;\n\n#else /* HAVE_SETREGID */\n        PyErr_BadInternalCall();\n        goto cleanup;\n#endif /* HAVE_SETREUID */\n    }\n\n    uid_t uid = (uid_t)-1;\n    if (uid_object != Py_None) {\n#ifdef HAVE_SETREUID\n        if (!_Py_Uid_Converter(uid_object, &uid))\n            goto cleanup;\n\n#else /* HAVE_SETREUID */\n        PyErr_BadInternalCall();\n        goto cleanup;\n#endif /* HAVE_SETREUID */\n    }\n\n    c_fds_to_keep = PyMem_Malloc(fds_to_keep_len * sizeof(int));\n    if (c_fds_to_keep == NULL) {\n        PyErr_SetString(PyExc_MemoryError, \"failed to malloc c_fds_to_keep\");\n        goto cleanup;\n    }\n    if (convert_fds_to_keep_to_c(py_fds_to_keep, c_fds_to_keep) < 0) {\n        goto cleanup;\n    }\n\n    /* This must be the last thing done before fork() because we do not\n     * want to call PyOS_BeforeFork() if there is any chance of another\n     * error leading to the cleanup: code without calling fork(). */\n    if (preexec_fn != Py_None) {\n        preexec_fn_args_tuple = PyTuple_New(0);\n        if (!preexec_fn_args_tuple)\n            goto cleanup;\n        PyOS_BeforeFork();\n        need_after_fork = 1;\n    }\n\n    /* NOTE: When old_sigmask is non-NULL, do_fork_exec() may use vfork(). */\n    const void *old_sigmask = NULL;\n#ifdef VFORK_USABLE\n    /* Use vfork() only if it's safe. See the comment above child_exec(). */\n    sigset_t old_sigs;\n    if (preexec_fn == Py_None && allow_vfork &&\n        uid == (uid_t)-1 && gid == (gid_t)-1 && extra_group_size < 0) {\n        /* Block all signals to ensure that no signal handlers are run in the\n         * child process while it shares memory with us. Note that signals\n         * used internally by C libraries won't be blocked by\n         * pthread_sigmask(), but signal handlers installed by C libraries\n         * normally service only signals originating from *within the process*,\n         * so it should be sufficient to consider any library function that\n         * might send such a signal to be vfork-unsafe and do not call it in\n         * the child.\n         */\n        sigset_t all_sigs;\n        sigfillset(&all_sigs);\n        if ((saved_errno = pthread_sigmask(SIG_BLOCK, &all_sigs, &old_sigs))) {\n            goto cleanup;\n        }\n        old_sigmask = &old_sigs;\n    }\n#endif\n\n    pid = do_fork_exec(exec_array, argv, envp, cwd,\n                       p2cread, p2cwrite, c2pread, c2pwrite,\n                       errread, errwrite, errpipe_read, errpipe_write,\n                       close_fds, restore_signals, call_setsid, pgid_to_set,\n                       gid, extra_group_size, extra_groups,\n                       uid, child_umask, old_sigmask,\n                       c_fds_to_keep, fds_to_keep_len,\n                       preexec_fn, preexec_fn_args_tuple);\n\n    /* Parent (original) process */\n    if (pid == (pid_t)-1) {\n        /* Capture errno for the exception. */\n        saved_errno = errno;\n    }\n\n#ifdef VFORK_USABLE\n    if (old_sigmask) {\n        /* vfork() semantics guarantees that the parent is blocked\n         * until the child performs _exit() or execve(), so it is safe\n         * to unblock signals once we're here.\n         * Note that in environments where vfork() is implemented as fork(),\n         * such as QEMU user-mode emulation, the parent won't be blocked,\n         * but it won't share the address space with the child,\n         * so it's still safe to unblock the signals.\n         *\n         * We don't handle errors here because this call can't fail\n         * if valid arguments are given, and because there is no good\n         * way for the caller to deal with a failure to restore\n         * the thread signal mask. */\n        (void) pthread_sigmask(SIG_SETMASK, old_sigmask, NULL);\n    }\n#endif\n\n    if (need_after_fork)\n        PyOS_AfterFork_Parent();\n\ncleanup:\n    if (c_fds_to_keep != NULL) {\n        PyMem_Free(c_fds_to_keep);\n    }\n\n    if (saved_errno != 0) {\n        errno = saved_errno;\n        /* We can't call this above as PyOS_AfterFork_Parent() calls back\n         * into Python code which would see the unreturned error. */\n        PyErr_SetFromErrno(PyExc_OSError);\n    }\n\n    Py_XDECREF(preexec_fn_args_tuple);\n    PyMem_RawFree(extra_groups);\n    Py_XDECREF(cwd_obj2);\n    if (envp)\n        _Py_FreeCharPArray(envp);\n    Py_XDECREF(converted_args);\n    Py_XDECREF(fast_args);\n    if (argv)\n        _Py_FreeCharPArray(argv);\n    if (exec_array)\n        _Py_FreeCharPArray(exec_array);\n\n    if (need_to_reenable_gc) {\n        PyGC_Enable();\n    }\n\n    return pid == -1 ? NULL : PyLong_FromPid(pid);\n}\n\n/* module level code ********************************************************/\n\nPyDoc_STRVAR(module_doc,\n\"A POSIX helper for the subprocess module.\");\n\nstatic PyMethodDef module_methods[] = {\n    SUBPROCESS_FORK_EXEC_METHODDEF\n    {NULL, NULL}  /* sentinel */\n};\n\nstatic PyModuleDef_Slot _posixsubprocess_slots[] = {\n    {Py_mod_multiple_interpreters, Py_MOD_PER_INTERPRETER_GIL_SUPPORTED},\n    {0, NULL}\n};\n\nstatic struct PyModuleDef _posixsubprocessmodule = {\n        PyModuleDef_HEAD_INIT,\n        .m_name = \"_posixsubprocess\",\n        .m_doc = module_doc,\n        .m_size = 0,\n        .m_methods = module_methods,\n        .m_slots = _posixsubprocess_slots,\n};\n\nPyMODINIT_FUNC\nPyInit__posixsubprocess(void)\n{\n    return PyModuleDef_Init(&_posixsubprocessmodule);\n}\n"}, "sourceLanguage": "c"}], "results": [{"ruleId": "-Wanalyzer-fd-leak", "taxa": [{"id": "775", "toolComponent": {"name": "cwe"}}], "level": "warning", "message": {"text": "leak of file descriptor 'dup2(p2cread, 0)'"}, "locations": [{"physicalLocation": {"artifactLocation": {"uri": "./Modules/_posixsubprocess.c", "uriBaseId": "PWD"}, "region": {"startLine": 636, "startColumn": 9, "endColumn": 10}, "contextRegion": {"startLine": 636, "snippet": {"text": "        POSIX_CALL(dup2(p2cread, 0));  /* stdin */\n"}}}, "logicalLocations": [{"name": "child_exec", "fullyQualifiedName": "child_exec", "decoratedName": "child_exec", "kind": "function"}]}], "codeFlows": [{"threadFlows": [{"locations": [{"location": {"physicalLocation": {"artifactLocation": {"uri": "./Modules/_posixsubprocess.c", "uriBaseId": "PWD"}, "region": {"startLine": 922, "startColumn": 1, "endColumn": 26}, "contextRegion": {"startLine": 922, "snippet": {"text": "subprocess_fork_exec_impl(PyObject *module, PyObject *process_args,\n"}}}, "logicalLocations": [{"name": "subprocess_fork_exec_impl", "fullyQualifiedName": "subprocess_fork_exec_impl", "decoratedName": "subprocess_fork_exec_impl", "kind": "function"}], "message": {"text": "entry to 'subprocess_fork_exec_impl'"}}, "kinds": ["enter", "function"], "nestingLevel": 1}, {"location": {"physicalLocation": {"artifactLocation": {"uri": "./Modules/_posixsubprocess.c", "uriBaseId": "PWD"}, "region": {"startLine": 962, "startColumn": 8, "endColumn": 9}, "contextRegion": {"startLine": 962, "snippet": {"text": "    if (close_fds && errpipe_write < 3) {  /* precondition */\n"}}}, "logicalLocations": [{"name": "subprocess_fork_exec_impl", "fullyQualifiedName": "subprocess_fork_exec_impl", "decoratedName": "subprocess_fork_exec_impl", "kind": "function"}], "message": {"text": "following 'false' branch..."}}, "kinds": ["branch", "false"], "nestingLevel": 1}, {"location": {"physicalLocation": {"artifactLocation": {"uri": "./Modules/_posixsubprocess.c", "uriBaseId": "PWD"}, "region": {"startLine": 966, "startColumn": 5, "endColumn": 7}, "contextRegion": {"startLine": 966, "snippet": {"text": "    if (_sanity_check_python_fd_sequence(py_fds_to_keep)) {\n"}}}, "logicalLocations": [{"name": "subprocess_fork_exec_impl", "fullyQualifiedName": "subprocess_fork_exec_impl", "decoratedName": "subprocess_fork_exec_impl", "kind": "function"}], "message": {"text": "...to here"}}, "kinds": ["branch", "false"], "nestingLevel": 1}, {"location": {"physicalLocation": {"artifactLocation": {"uri": "./Modules/_posixsubprocess.c", "uriBaseId": "PWD"}, "region": {"startLine": 966, "startColumn": 8, "endColumn": 9}, "contextRegion": {"startLine": 966, "snippet": {"text": "    if (_sanity_check_python_fd_sequence(py_fds_to_keep)) {\n"}}}, "logicalLocations": [{"name": "subprocess_fork_exec_impl", "fullyQualifiedName": "subprocess_fork_exec_impl", "decoratedName": "subprocess_fork_exec_impl", "kind": "function"}], "message": {"text": "following 'false' branch..."}}, "kinds": ["branch", "false"], "nestingLevel": 1}, {"location": {"physicalLocation": {"artifactLocation": {"uri": "./Modules/_posixsubprocess.c", "uriBaseId": "PWD"}, "region": {"startLine": 972, "startColumn": 5, "endColumn": 7}, "contextRegion": {"startLine": 972, "snippet": {"text": "    if (preexec_fn != Py_None) {\n"}}}, "logicalLocations": [{"name": "subprocess_fork_exec_impl", "fullyQualifiedName": "subprocess_fork_exec_impl", "decoratedName": "subprocess_fork_exec_impl", "kind": "function"}], "message": {"text": "...to here"}}, "kinds": ["branch", "false"], "nestingLevel": 1}, {"location": {"physicalLocation": {"artifactLocation": {"uri": "./Modules/_posixsubprocess.c", "uriBaseId": "PWD"}, "region": {"startLine": 977, "startColumn": 8, "endColumn": 9}, "contextRegion": {"startLine": 977, "snippet": {"text": "    if (!exec_array)\n"}}}, "logicalLocations": [{"name": "subprocess_fork_exec_impl", "fullyQualifiedName": "subprocess_fork_exec_impl", "decoratedName": "subprocess_fork_exec_impl", "kind": "function"}], "message": {"text": "following 'false' branch (when 'exec_array' is non-NULL)..."}}, "kinds": ["branch", "false"], "nestingLevel": 1}, {"location": {"physicalLocation": {"artifactLocation": {"uri": "./Modules/_posixsubprocess.c", "uriBaseId": "PWD"}, "region": {"startLine": 983, "startColumn": 5, "endColumn": 7}, "contextRegion": {"startLine": 983, "snippet": {"text": "    if (process_args != Py_None) {\n"}}}, "logicalLocations": [{"name": "subprocess_fork_exec_impl", "fullyQualifiedName": "subprocess_fork_exec_impl", "decoratedName": "subprocess_fork_exec_impl", "kind": "function"}], "message": {"text": "...to here"}}, "kinds": ["branch", "false"], "nestingLevel": 1}, {"location": {"physicalLocation": {"artifactLocation": {"uri": "./Modules/_posixsubprocess.c", "uriBaseId": "PWD"}, "region": {"startLine": 983, "startColumn": 8, "endColumn": 9}, "contextRegion": {"startLine": 983, "snippet": {"text": "    if (process_args != Py_None) {\n"}}}, "logicalLocations": [{"name": "subprocess_fork_exec_impl", "fullyQualifiedName": "subprocess_fork_exec_impl", "decoratedName": "subprocess_fork_exec_impl", "kind": "function"}], "message": {"text": "following 'false' branch..."}}, "kinds": ["branch", "false"], "nestingLevel": 1}, {"location": {"physicalLocation": {"artifactLocation": {"uri": "./Modules/_posixsubprocess.c", "uriBaseId": "PWD"}, "region": {"startLine": 1013, "startColumn": 5, "endColumn": 7}, "contextRegion": {"startLine": 1013, "snippet": {"text": "    if (env_list != Py_None) {\n"}}}, "logicalLocations": [{"name": "subprocess_fork_exec_impl", "fullyQualifiedName": "subprocess_fork_exec_impl", "decoratedName": "subprocess_fork_exec_impl", "kind": "function"}], "message": {"text": "...to here"}}, "kinds": ["branch", "false"], "nestingLevel": 1}, {"location": {"physicalLocation": {"artifactLocation": {"uri": "./Modules/_posixsubprocess.c", "uriBaseId": "PWD"}, "region": {"startLine": 1013, "startColumn": 8, "endColumn": 9}, "contextRegion": {"startLine": 1013, "snippet": {"text": "    if (env_list != Py_None) {\n"}}}, "logicalLocations": [{"name": "subprocess_fork_exec_impl", "fullyQualifiedName": "subprocess_fork_exec_impl", "decoratedName": "subprocess_fork_exec_impl", "kind": "function"}], "message": {"text": "following 'false' branch..."}}, "kinds": ["branch", "false"], "nestingLevel": 1}, {"location": {"physicalLocation": {"artifactLocation": {"uri": "./Modules/_posixsubprocess.c", "uriBaseId": "PWD"}, "region": {"startLine": 1019, "startColumn": 5, "endColumn": 7}, "contextRegion": {"startLine": 1019, "snippet": {"text": "    if (cwd_obj != Py_None) {\n"}}}, "logicalLocations": [{"name": "subprocess_fork_exec_impl", "fullyQualifiedName": "subprocess_fork_exec_impl", "decoratedName": "subprocess_fork_exec_impl", "kind": "function"}], "message": {"text": "...to here"}}, "kinds": ["branch", "false"], "nestingLevel": 1}, {"location": {"physicalLocation": {"artifactLocation": {"uri": "./Modules/_posixsubprocess.c", "uriBaseId": "PWD"}, "region": {"startLine": 1019, "startColumn": 8, "endColumn": 9}, "contextRegion": {"startLine": 1019, "snippet": {"text": "    if (cwd_obj != Py_None) {\n"}}}, "logicalLocations": [{"name": "subprocess_fork_exec_impl", "fullyQualifiedName": "subprocess_fork_exec_impl", "decoratedName": "subprocess_fork_exec_impl", "kind": "function"}], "message": {"text": "following 'false' branch..."}}, "kinds": ["branch", "false"], "nestingLevel": 1}, {"location": {"physicalLocation": {"artifactLocation": {"uri": "./Modules/_posixsubprocess.c", "uriBaseId": "PWD"}, "region": {"startLine": 1030, "startColumn": 5, "endColumn": 15}, "contextRegion": {"startLine": 1030, "snippet": {"text": "    Py_ssize_t extra_group_size = -2;\n"}}}, "logicalLocations": [{"name": "subprocess_fork_exec_impl", "fullyQualifiedName": "subprocess_fork_exec_impl", "decoratedName": "subprocess_fork_exec_impl", "kind": "function"}], "message": {"text": "...to here"}}, "kinds": ["branch", "false"], "nestingLevel": 1}, {"location": {"physicalLocation": {"artifactLocation": {"uri": "./Modules/_posixsubprocess.c", "uriBaseId": "PWD"}, "region": {"startLine": 1032, "startColumn": 8, "endColumn": 9}, "contextRegion": {"startLine": 1032, "snippet": {"text": "    if (extra_groups_packed != Py_None) {\n"}}}, "logicalLocations": [{"name": "subprocess_fork_exec_impl", "fullyQualifiedName": "subprocess_fork_exec_impl", "decoratedName": "subprocess_fork_exec_impl", "kind": "function"}], "message": {"text": "following 'false' branch..."}}, "kinds": ["branch", "false"], "nestingLevel": 1}, {"location": {"physicalLocation": {"artifactLocation": {"uri": "./Modules/_posixsubprocess.c", "uriBaseId": "PWD"}, "region": {"startLine": 1087, "startColumn": 5, "endColumn": 10}, "contextRegion": {"startLine": 1087, "snippet": {"text": "    gid_t gid = (gid_t)-1;\n"}}}, "logicalLocations": [{"name": "subprocess_fork_exec_impl", "fullyQualifiedName": "subprocess_fork_exec_impl", "decoratedName": "subprocess_fork_exec_impl", "kind": "function"}], "message": {"text": "...to here"}}, "kinds": ["branch", "false"], "nestingLevel": 1}, {"location": {"physicalLocation": {"artifactLocation": {"uri": "./Modules/_posixsubprocess.c", "uriBaseId": "PWD"}, "region": {"startLine": 1112, "startColumn": 8, "endColumn": 9}, "contextRegion": {"startLine": 1112, "snippet": {"text": "    if (c_fds_to_keep == NULL) {\n"}}}, "logicalLocations": [{"name": "subprocess_fork_exec_impl", "fullyQualifiedName": "subprocess_fork_exec_impl", "decoratedName": "subprocess_fork_exec_impl", "kind": "function"}], "message": {"text": "following 'false' branch (when 'c_fds_to_keep' is non-NULL)..."}}, "kinds": ["branch", "false"], "nestingLevel": 1}, {"location": {"physicalLocation": {"artifactLocation": {"uri": "./Modules/_posixsubprocess.c", "uriBaseId": "PWD"}, "region": {"startLine": 1116, "startColumn": 5, "endColumn": 7}, "contextRegion": {"startLine": 1116, "snippet": {"text": "    if (convert_fds_to_keep_to_c(py_fds_to_keep, c_fds_to_keep) < 0) {\n"}}}, "logicalLocations": [{"name": "subprocess_fork_exec_impl", "fullyQualifiedName": "subprocess_fork_exec_impl", "decoratedName": "subprocess_fork_exec_impl", "kind": "function"}], "message": {"text": "...to here"}}, "kinds": ["branch", "false"], "nestingLevel": 1}, {"location": {"physicalLocation": {"artifactLocation": {"uri": "./Modules/_posixsubprocess.c", "uriBaseId": "PWD"}, "region": {"startLine": 1116, "startColumn": 8, "endColumn": 9}, "contextRegion": {"startLine": 1116, "snippet": {"text": "    if (convert_fds_to_keep_to_c(py_fds_to_keep, c_fds_to_keep) < 0) {\n"}}}, "logicalLocations": [{"name": "subprocess_fork_exec_impl", "fullyQualifiedName": "subprocess_fork_exec_impl", "decoratedName": "subprocess_fork_exec_impl", "kind": "function"}], "message": {"text": "following 'false' branch..."}}, "kinds": ["branch", "false"], "nestingLevel": 1}, {"location": {"physicalLocation": {"artifactLocation": {"uri": "./Modules/_posixsubprocess.c", "uriBaseId": "PWD"}, "region": {"startLine": 1123, "startColumn": 5, "endColumn": 7}, "contextRegion": {"startLine": 1123, "snippet": {"text": "    if (preexec_fn != Py_None) {\n"}}}, "logicalLocations": [{"name": "subprocess_fork_exec_impl", "fullyQualifiedName": "subprocess_fork_exec_impl", "decoratedName": "subprocess_fork_exec_impl", "kind": "function"}], "message": {"text": "...to here"}}, "kinds": ["branch", "false"], "nestingLevel": 1}, {"location": {"physicalLocation": {"artifactLocation": {"uri": "./Modules/_posixsubprocess.c", "uriBaseId": "PWD"}, "region": {"startLine": 1123, "startColumn": 8, "endColumn": 9}, "contextRegion": {"startLine": 1123, "snippet": {"text": "    if (preexec_fn != Py_None) {\n"}}}, "logicalLocations": [{"name": "subprocess_fork_exec_impl", "fullyQualifiedName": "subprocess_fork_exec_impl", "decoratedName": "subprocess_fork_exec_impl", "kind": "function"}], "message": {"text": "following 'false' branch..."}}, "kinds": ["branch", "false"], "nestingLevel": 1}, {"location": {"physicalLocation": {"artifactLocation": {"uri": "./Modules/_posixsubprocess.c", "uriBaseId": "PWD"}, "region": {"startLine": 1132, "startColumn": 5, "endColumn": 10}, "contextRegion": {"startLine": 1132, "snippet": {"text": "    const void *old_sigmask = NULL;\n"}}}, "logicalLocations": [{"name": "subprocess_fork_exec_impl", "fullyQualifiedName": "subprocess_fork_exec_impl", "decoratedName": "subprocess_fork_exec_impl", "kind": "function"}], "message": {"text": "...to here"}}, "kinds": ["branch", "false"], "nestingLevel": 1}, {"location": {"physicalLocation": {"artifactLocation": {"uri": "./Modules/_posixsubprocess.c", "uriBaseId": "PWD"}, "region": {"startLine": 1156, "startColumn": 11, "endLine": 1163, "endColumn": 58}, "contextRegion": {"startLine": 1156, "endLine": 1163, "snippet": {"text": "    pid = do_fork_exec(exec_array, argv, envp, cwd,\n                       p2cread, p2cwrite, c2pread, c2pwrite,\n                       errread, errwrite, errpipe_read, errpipe_write,\n                       close_fds, restore_signals, call_setsid, pgid_to_set,\n                       gid, extra_group_size, extra_groups,\n                       uid, child_umask, old_sigmask,\n                       c_fds_to_keep, fds_to_keep_len,\n                       preexec_fn, preexec_fn_args_tuple);\n"}}}, "logicalLocations": [{"name": "subprocess_fork_exec_impl", "fullyQualifiedName": "subprocess_fork_exec_impl", "decoratedName": "subprocess_fork_exec_impl", "kind": "function"}], "message": {"text": "calling 'do_fork_exec' from 'subprocess_fork_exec_impl'"}}, "kinds": ["call", "function"], "nestingLevel": 1}, {"location": {"physicalLocation": {"artifactLocation": {"uri": "./Modules/_posixsubprocess.c", "uriBaseId": "PWD"}, "region": {"startLine": 783, "startColumn": 1, "endColumn": 13}, "contextRegion": {"startLine": 783, "snippet": {"text": "do_fork_exec(char *const exec_array[],\n"}}}, "logicalLocations": [{"name": "do_fork_exec", "fullyQualifiedName": "do_fork_exec", "decoratedName": "do_fork_exec", "kind": "function"}], "message": {"text": "entry to 'do_fork_exec'"}}, "kinds": ["enter", "function"], "nestingLevel": 2}, {"location": {"physicalLocation": {"artifactLocation": {"uri": "./Modules/_posixsubprocess.c", "uriBaseId": "PWD"}, "region": {"startLine": 806, "startColumn": 8, "endColumn": 9}, "contextRegion": {"startLine": 806, "snippet": {"text": "    if (child_sigmask) {\n"}}}, "logicalLocations": [{"name": "do_fork_exec", "fullyQualifiedName": "do_fork_exec", "decoratedName": "do_fork_exec", "kind": "function"}], "message": {"text": "following 'false' branch (when 'child_sigmask' is NULL)..."}}, "kinds": ["branch", "false"], "nestingLevel": 2}, {"location": {"physicalLocation": {"artifactLocation": {"uri": "./Modules/_posixsubprocess.c", "uriBaseId": "PWD"}, "region": {"startLine": 838, "startColumn": 9, "endColumn": 12}, "contextRegion": {"startLine": 838, "snippet": {"text": "        pid = fork();\n"}}}, "logicalLocations": [{"name": "do_fork_exec", "fullyQualifiedName": "do_fork_exec", "decoratedName": "do_fork_exec", "kind": "function"}], "message": {"text": "...to here"}}, "kinds": ["branch", "false"], "nestingLevel": 2}, {"location": {"physicalLocation": {"artifactLocation": {"uri": "./Modules/_posixsubprocess.c", "uriBaseId": "PWD"}, "region": {"startLine": 841, "startColumn": 8, "endColumn": 9}, "contextRegion": {"startLine": 841, "snippet": {"text": "    if (pid != 0) {\n"}}}, "logicalLocations": [{"name": "do_fork_exec", "fullyQualifiedName": "do_fork_exec", "decoratedName": "do_fork_exec", "kind": "function"}], "message": {"text": "following 'false' branch (when 'pid == 0')..."}}, "kinds": ["branch", "false"], "nestingLevel": 2}, {"location": {"physicalLocation": {"artifactLocation": {"uri": "./Modules/_posixsubprocess.c", "uriBaseId": "PWD"}, "region": {"startLine": 851, "startColumn": 5, "endColumn": 7}, "contextRegion": {"startLine": 851, "snippet": {"text": "    if (preexec_fn != Py_None) {\n"}}}, "logicalLocations": [{"name": "do_fork_exec", "fullyQualifiedName": "do_fork_exec", "decoratedName": "do_fork_exec", "kind": "function"}], "message": {"text": "...to here"}}, "kinds": ["branch", "false"], "nestingLevel": 2}, {"location": {"physicalLocation": {"artifactLocation": {"uri": "./Modules/_posixsubprocess.c", "uriBaseId": "PWD"}, "region": {"startLine": 859, "startColumn": 5, "endLine": 866, "endColumn": 50}, "contextRegion": {"startLine": 859, "endLine": 866, "snippet": {"text": "    child_exec(exec_array, argv, envp, cwd,\n               p2cread, p2cwrite, c2pread, c2pwrite,\n               errread, errwrite, errpipe_read, errpipe_write,\n               close_fds, restore_signals, call_setsid, pgid_to_set,\n               gid, extra_group_size, extra_groups,\n               uid, child_umask, child_sigmask,\n               fds_to_keep, fds_to_keep_len,\n               preexec_fn, preexec_fn_args_tuple);\n"}}}, "logicalLocations": [{"name": "do_fork_exec", "fullyQualifiedName": "do_fork_exec", "decoratedName": "do_fork_exec", "kind": "function"}], "message": {"text": "calling 'child_exec' from 'do_fork_exec'"}}, "kinds": ["call", "function"], "nestingLevel": 2}, {"location": {"physicalLocation": {"artifactLocation": {"uri": "./Modules/_posixsubprocess.c", "uriBaseId": "PWD"}, "region": {"startLine": 574, "startColumn": 1, "endColumn": 11}, "contextRegion": {"startLine": 574, "snippet": {"text": "child_exec(char *const exec_array[],\n"}}}, "logicalLocations": [{"name": "child_exec", "fullyQualifiedName": "child_exec", "decoratedName": "child_exec", "kind": "function"}], "message": {"text": "entry to 'child_exec'"}}, "kinds": ["enter", "function"], "nestingLevel": 3}, {"location": {"physicalLocation": {"artifactLocation": {"uri": "./Modules/_posixsubprocess.c", "uriBaseId": "PWD"}, "region": {"startLine": 599, "startColumn": 8, "endColumn": 9}, "contextRegion": {"startLine": 599, "snippet": {"text": "    if (make_inheritable(fds_to_keep, fds_to_keep_len, errpipe_write) < 0)\n"}}}, "logicalLocations": [{"name": "child_exec", "fullyQualifiedName": "child_exec", "decoratedName": "child_exec", "kind": "function"}], "message": {"text": "following 'false' branch..."}}, "kinds": ["branch", "false"], "nestingLevel": 3}, {"location": {"physicalLocation": {"artifactLocation": {"uri": "./Modules/_posixsubprocess.c", "uriBaseId": "PWD"}, "region": {"startLine": 603, "startColumn": 5, "endColumn": 7}, "contextRegion": {"startLine": 603, "snippet": {"text": "    if (p2cwrite != -1)\n"}}}, "logicalLocations": [{"name": "child_exec", "fullyQualifiedName": "child_exec", "decoratedName": "child_exec", "kind": "function"}], "message": {"text": "...to here"}}, "kinds": ["branch", "false"], "nestingLevel": 3}, {"location": {"physicalLocation": {"artifactLocation": {"uri": "./Modules/_posixsubprocess.c", "uriBaseId": "PWD"}, "region": {"startLine": 603, "startColumn": 8, "endColumn": 9}, "contextRegion": {"startLine": 603, "snippet": {"text": "    if (p2cwrite != -1)\n"}}}, "logicalLocations": [{"name": "child_exec", "fullyQualifiedName": "child_exec", "decoratedName": "child_exec", "kind": "function"}], "message": {"text": "following 'false' branch (when 'p2cwrite == -1')..."}}, "kinds": ["branch", "false"], "nestingLevel": 3}, {"location": {"physicalLocation": {"artifactLocation": {"uri": "./Modules/_posixsubprocess.c", "uriBaseId": "PWD"}, "region": {"startLine": 604, "startColumn": 9, "endColumn": 10}, "contextRegion": {"startLine": 604, "snippet": {"text": "        POSIX_CALL(close(p2cwrite));\n"}}}, "logicalLocations": [{"name": "child_exec", "fullyQualifiedName": "child_exec", "decoratedName": "child_exec", "kind": "function"}], "message": {"text": "...to here"}}, "kinds": ["branch", "false"], "nestingLevel": 3}, {"location": {"physicalLocation": {"artifactLocation": {"uri": "./Modules/_posixsubprocess.c", "uriBaseId": "PWD"}, "region": {"startLine": 605, "startColumn": 8, "endColumn": 9}, "contextRegion": {"startLine": 605, "snippet": {"text": "    if (c2pread != -1)\n"}}}, "logicalLocations": [{"name": "child_exec", "fullyQualifiedName": "child_exec", "decoratedName": "child_exec", "kind": "function"}], "message": {"text": "following 'false' branch (when 'c2pread == -1')..."}}, "kinds": ["branch", "false"], "nestingLevel": 3}, {"location": {"physicalLocation": {"artifactLocation": {"uri": "./Modules/_posixsubprocess.c", "uriBaseId": "PWD"}, "region": {"startLine": 606, "startColumn": 9, "endColumn": 10}, "contextRegion": {"startLine": 606, "snippet": {"text": "        POSIX_CALL(close(c2pread));\n"}}}, "logicalLocations": [{"name": "child_exec", "fullyQualifiedName": "child_exec", "decoratedName": "child_exec", "kind": "function"}], "message": {"text": "...to here"}}, "kinds": ["branch", "false"], "nestingLevel": 3}, {"location": {"physicalLocation": {"artifactLocation": {"uri": "./Modules/_posixsubprocess.c", "uriBaseId": "PWD"}, "region": {"startLine": 607, "startColumn": 8, "endColumn": 9}, "contextRegion": {"startLine": 607, "snippet": {"text": "    if (errread != -1)\n"}}}, "logicalLocations": [{"name": "child_exec", "fullyQualifiedName": "child_exec", "decoratedName": "child_exec", "kind": "function"}], "message": {"text": "following 'false' branch (when 'errread == -1')..."}}, "kinds": ["branch", "false"], "nestingLevel": 3}, {"location": {"physicalLocation": {"artifactLocation": {"uri": "./Modules/_posixsubprocess.c", "uriBaseId": "PWD"}, "region": {"startLine": 608, "startColumn": 9, "endColumn": 10}, "contextRegion": {"startLine": 608, "snippet": {"text": "        POSIX_CALL(close(errread));\n"}}}, "logicalLocations": [{"name": "child_exec", "fullyQualifiedName": "child_exec", "decoratedName": "child_exec", "kind": "function"}], "message": {"text": "...to here"}}, "kinds": ["branch", "false"], "nestingLevel": 3}, {"location": {"physicalLocation": {"artifactLocation": {"uri": "./Modules/_posixsubprocess.c", "uriBaseId": "PWD"}, "region": {"startLine": 609, "startColumn": 5, "endColumn": 6}, "contextRegion": {"startLine": 609, "snippet": {"text": "    POSIX_CALL(close(errpipe_read));\n"}}}, "logicalLocations": [{"name": "child_exec", "fullyQualifiedName": "child_exec", "decoratedName": "child_exec", "kind": "function"}], "message": {"text": "following 'false' branch..."}}, "kinds": ["branch", "false"], "nestingLevel": 3}, {"location": {"physicalLocation": {"artifactLocation": {"uri": "./Modules/_posixsubprocess.c", "uriBaseId": "PWD"}, "region": {"startLine": 609, "startColumn": 5, "endColumn": 6}, "contextRegion": {"startLine": 609, "snippet": {"text": "    POSIX_CALL(close(errpipe_read));\n"}}}, "logicalLocations": [{"name": "child_exec", "fullyQualifiedName": "child_exec", "decoratedName": "child_exec", "kind": "function"}], "message": {"text": "...to here"}}, "kinds": ["branch", "false"], "nestingLevel": 3}, {"location": {"physicalLocation": {"artifactLocation": {"uri": "./Modules/_posixsubprocess.c", "uriBaseId": "PWD"}, "region": {"startLine": 620, "startColumn": 12, "endColumn": 42}, "contextRegion": {"startLine": 620, "snippet": {"text": "    while (errwrite == 0 || errwrite == 1) {\n"}}}, "logicalLocations": [{"name": "child_exec", "fullyQualifiedName": "child_exec", "decoratedName": "child_exec", "kind": "function"}], "message": {"text": "following 'false' branch..."}}, "kinds": ["branch", "false"], "nestingLevel": 3}, {"location": {"physicalLocation": {"artifactLocation": {"uri": "./Modules/_posixsubprocess.c", "uriBaseId": "PWD"}, "region": {"startLine": 631, "startColumn": 5, "endColumn": 7}, "contextRegion": {"startLine": 631, "snippet": {"text": "    if (p2cread == 0) {\n"}}}, "logicalLocations": [{"name": "child_exec", "fullyQualifiedName": "child_exec", "decoratedName": "child_exec", "kind": "function"}], "message": {"text": "...to here"}}, "kinds": ["branch", "false"], "nestingLevel": 3}, {"location": {"physicalLocation": {"artifactLocation": {"uri": "./Modules/_posixsubprocess.c", "uriBaseId": "PWD"}, "region": {"startLine": 631, "startColumn": 8, "endColumn": 9}, "contextRegion": {"startLine": 631, "snippet": {"text": "    if (p2cread == 0) {\n"}}}, "logicalLocations": [{"name": "child_exec", "fullyQualifiedName": "child_exec", "decoratedName": "child_exec", "kind": "function"}], "message": {"text": "following 'false' branch (when 'p2cread != 0')..."}}, "kinds": ["branch", "false"], "nestingLevel": 3}, {"location": {"physicalLocation": {"artifactLocation": {"uri": "./Modules/_posixsubprocess.c", "uriBaseId": "PWD"}, "region": {"startLine": 635, "startColumn": 10, "endColumn": 12}, "contextRegion": {"startLine": 635, "snippet": {"text": "    else if (p2cread != -1)\n"}}}, "logicalLocations": [{"name": "child_exec", "fullyQualifiedName": "child_exec", "decoratedName": "child_exec", "kind": "function"}], "message": {"text": "...to here"}}, "kinds": ["branch", "false"], "nestingLevel": 3}, {"location": {"physicalLocation": {"artifactLocation": {"uri": "./Modules/_posixsubprocess.c", "uriBaseId": "PWD"}, "region": {"startLine": 635, "startColumn": 13, "endColumn": 14}, "contextRegion": {"startLine": 635, "snippet": {"text": "    else if (p2cread != -1)\n"}}}, "logicalLocations": [{"name": "child_exec", "fullyQualifiedName": "child_exec", "decoratedName": "child_exec", "kind": "function"}], "message": {"text": "following 'true' branch (when 'p2cread != -1')..."}}, "kinds": ["branch", "true"], "nestingLevel": 3}, {"location": {"physicalLocation": {"artifactLocation": {"uri": "./Modules/_posixsubprocess.c", "uriBaseId": "PWD"}, "region": {"startLine": 636, "startColumn": 9, "endColumn": 10}, "contextRegion": {"startLine": 636, "snippet": {"text": "        POSIX_CALL(dup2(p2cread, 0));  /* stdin */\n"}}}, "logicalLocations": [{"name": "child_exec", "fullyQualifiedName": "child_exec", "decoratedName": "child_exec", "kind": "function"}], "message": {"text": "...to here"}}, "kinds": ["branch", "true"], "nestingLevel": 3}, {"location": {"physicalLocation": {"artifactLocation": {"uri": "./Modules/_posixsubprocess.c", "uriBaseId": "PWD"}, "region": {"startLine": 636, "startColumn": 9, "endColumn": 10}, "contextRegion": {"startLine": 636, "snippet": {"text": "        POSIX_CALL(dup2(p2cread, 0));  /* stdin */\n"}}}, "logicalLocations": [{"name": "child_exec", "fullyQualifiedName": "child_exec", "decoratedName": "child_exec", "kind": "function"}], "message": {"text": "opened here"}}, "kinds": ["acquire", "resource"], "nestingLevel": 3}, {"location": {"physicalLocation": {"artifactLocation": {"uri": "./Modules/_posixsubprocess.c", "uriBaseId": "PWD"}, "region": {"startLine": 636, "startColumn": 9, "endColumn": 10}, "contextRegion": {"startLine": 636, "snippet": {"text": "        POSIX_CALL(dup2(p2cread, 0));  /* stdin */\n"}}}, "logicalLocations": [{"name": "child_exec", "fullyQualifiedName": "child_exec", "decoratedName": "child_exec", "kind": "function"}], "message": {"text": "'dup2(p2cread, 0)' leaks here; was opened at (46)"}}, "kinds": ["danger"], "nestingLevel": 3}]}]}]}, {"ruleId": "-Wanalyzer-fd-leak", "taxa": [{"id": "775", "toolComponent": {"name": "cwe"}}], "level": "warning", "message": {"text": "leak of file descriptor 'dup2(c2pwrite, 1)'"}, "locations": [{"physicalLocation": {"artifactLocation": {"uri": "./Modules/_posixsubprocess.c", "uriBaseId": "PWD"}, "region": {"startLine": 643, "startColumn": 9, "endColumn": 10}, "contextRegion": {"startLine": 643, "snippet": {"text": "        POSIX_CALL(dup2(c2pwrite, 1));  /* stdout */\n"}}}, "logicalLocations": [{"name": "child_exec", "fullyQualifiedName": "child_exec", "decoratedName": "child_exec", "kind": "function"}]}], "codeFlows": [{"threadFlows": [{"locations": [{"location": {"physicalLocation": {"artifactLocation": {"uri": "./Modules/_posixsubprocess.c", "uriBaseId": "PWD"}, "region": {"startLine": 922, "startColumn": 1, "endColumn": 26}, "contextRegion": {"startLine": 922, "snippet": {"text": "subprocess_fork_exec_impl(PyObject *module, PyObject *process_args,\n"}}}, "logicalLocations": [{"name": "subprocess_fork_exec_impl", "fullyQualifiedName": "subprocess_fork_exec_impl", "decoratedName": "subprocess_fork_exec_impl", "kind": "function"}], "message": {"text": "entry to 'subprocess_fork_exec_impl'"}}, "kinds": ["enter", "function"], "nestingLevel": 1}, {"location": {"physicalLocation": {"artifactLocation": {"uri": "./Modules/_posixsubprocess.c", "uriBaseId": "PWD"}, "region": {"startLine": 962, "startColumn": 8, "endColumn": 9}, "contextRegion": {"startLine": 962, "snippet": {"text": "    if (close_fds && errpipe_write < 3) {  /* precondition */\n"}}}, "logicalLocations": [{"name": "subprocess_fork_exec_impl", "fullyQualifiedName": "subprocess_fork_exec_impl", "decoratedName": "subprocess_fork_exec_impl", "kind": "function"}], "message": {"text": "following 'false' branch..."}}, "kinds": ["branch", "false"], "nestingLevel": 1}, {"location": {"physicalLocation": {"artifactLocation": {"uri": "./Modules/_posixsubprocess.c", "uriBaseId": "PWD"}, "region": {"startLine": 966, "startColumn": 5, "endColumn": 7}, "contextRegion": {"startLine": 966, "snippet": {"text": "    if (_sanity_check_python_fd_sequence(py_fds_to_keep)) {\n"}}}, "logicalLocations": [{"name": "subprocess_fork_exec_impl", "fullyQualifiedName": "subprocess_fork_exec_impl", "decoratedName": "subprocess_fork_exec_impl", "kind": "function"}], "message": {"text": "...to here"}}, "kinds": ["branch", "false"], "nestingLevel": 1}, {"location": {"physicalLocation": {"artifactLocation": {"uri": "./Modules/_posixsubprocess.c", "uriBaseId": "PWD"}, "region": {"startLine": 966, "startColumn": 8, "endColumn": 9}, "contextRegion": {"startLine": 966, "snippet": {"text": "    if (_sanity_check_python_fd_sequence(py_fds_to_keep)) {\n"}}}, "logicalLocations": [{"name": "subprocess_fork_exec_impl", "fullyQualifiedName": "subprocess_fork_exec_impl", "decoratedName": "subprocess_fork_exec_impl", "kind": "function"}], "message": {"text": "following 'false' branch..."}}, "kinds": ["branch", "false"], "nestingLevel": 1}, {"location": {"physicalLocation": {"artifactLocation": {"uri": "./Modules/_posixsubprocess.c", "uriBaseId": "PWD"}, "region": {"startLine": 972, "startColumn": 5, "endColumn": 7}, "contextRegion": {"startLine": 972, "snippet": {"text": "    if (preexec_fn != Py_None) {\n"}}}, "logicalLocations": [{"name": "subprocess_fork_exec_impl", "fullyQualifiedName": "subprocess_fork_exec_impl", "decoratedName": "subprocess_fork_exec_impl", "kind": "function"}], "message": {"text": "...to here"}}, "kinds": ["branch", "false"], "nestingLevel": 1}, {"location": {"physicalLocation": {"artifactLocation": {"uri": "./Modules/_posixsubprocess.c", "uriBaseId": "PWD"}, "region": {"startLine": 977, "startColumn": 8, "endColumn": 9}, "contextRegion": {"startLine": 977, "snippet": {"text": "    if (!exec_array)\n"}}}, "logicalLocations": [{"name": "subprocess_fork_exec_impl", "fullyQualifiedName": "subprocess_fork_exec_impl", "decoratedName": "subprocess_fork_exec_impl", "kind": "function"}], "message": {"text": "following 'false' branch (when 'exec_array' is non-NULL)..."}}, "kinds": ["branch", "false"], "nestingLevel": 1}, {"location": {"physicalLocation": {"artifactLocation": {"uri": "./Modules/_posixsubprocess.c", "uriBaseId": "PWD"}, "region": {"startLine": 983, "startColumn": 5, "endColumn": 7}, "contextRegion": {"startLine": 983, "snippet": {"text": "    if (process_args != Py_None) {\n"}}}, "logicalLocations": [{"name": "subprocess_fork_exec_impl", "fullyQualifiedName": "subprocess_fork_exec_impl", "decoratedName": "subprocess_fork_exec_impl", "kind": "function"}], "message": {"text": "...to here"}}, "kinds": ["branch", "false"], "nestingLevel": 1}, {"location": {"physicalLocation": {"artifactLocation": {"uri": "./Modules/_posixsubprocess.c", "uriBaseId": "PWD"}, "region": {"startLine": 983, "startColumn": 8, "endColumn": 9}, "contextRegion": {"startLine": 983, "snippet": {"text": "    if (process_args != Py_None) {\n"}}}, "logicalLocations": [{"name": "subprocess_fork_exec_impl", "fullyQualifiedName": "subprocess_fork_exec_impl", "decoratedName": "subprocess_fork_exec_impl", "kind": "function"}], "message": {"text": "following 'false' branch..."}}, "kinds": ["branch", "false"], "nestingLevel": 1}, {"location": {"physicalLocation": {"artifactLocation": {"uri": "./Modules/_posixsubprocess.c", "uriBaseId": "PWD"}, "region": {"startLine": 1013, "startColumn": 5, "endColumn": 7}, "contextRegion": {"startLine": 1013, "snippet": {"text": "    if (env_list != Py_None) {\n"}}}, "logicalLocations": [{"name": "subprocess_fork_exec_impl", "fullyQualifiedName": "subprocess_fork_exec_impl", "decoratedName": "subprocess_fork_exec_impl", "kind": "function"}], "message": {"text": "...to here"}}, "kinds": ["branch", "false"], "nestingLevel": 1}, {"location": {"physicalLocation": {"artifactLocation": {"uri": "./Modules/_posixsubprocess.c", "uriBaseId": "PWD"}, "region": {"startLine": 1013, "startColumn": 8, "endColumn": 9}, "contextRegion": {"startLine": 1013, "snippet": {"text": "    if (env_list != Py_None) {\n"}}}, "logicalLocations": [{"name": "subprocess_fork_exec_impl", "fullyQualifiedName": "subprocess_fork_exec_impl", "decoratedName": "subprocess_fork_exec_impl", "kind": "function"}], "message": {"text": "following 'false' branch..."}}, "kinds": ["branch", "false"], "nestingLevel": 1}, {"location": {"physicalLocation": {"artifactLocation": {"uri": "./Modules/_posixsubprocess.c", "uriBaseId": "PWD"}, "region": {"startLine": 1019, "startColumn": 5, "endColumn": 7}, "contextRegion": {"startLine": 1019, "snippet": {"text": "    if (cwd_obj != Py_None) {\n"}}}, "logicalLocations": [{"name": "subprocess_fork_exec_impl", "fullyQualifiedName": "subprocess_fork_exec_impl", "decoratedName": "subprocess_fork_exec_impl", "kind": "function"}], "message": {"text": "...to here"}}, "kinds": ["branch", "false"], "nestingLevel": 1}, {"location": {"physicalLocation": {"artifactLocation": {"uri": "./Modules/_posixsubprocess.c", "uriBaseId": "PWD"}, "region": {"startLine": 1019, "startColumn": 8, "endColumn": 9}, "contextRegion": {"startLine": 1019, "snippet": {"text": "    if (cwd_obj != Py_None) {\n"}}}, "logicalLocations": [{"name": "subprocess_fork_exec_impl", "fullyQualifiedName": "subprocess_fork_exec_impl", "decoratedName": "subprocess_fork_exec_impl", "kind": "function"}], "message": {"text": "following 'false' branch..."}}, "kinds": ["branch", "false"], "nestingLevel": 1}, {"location": {"physicalLocation": {"artifactLocation": {"uri": "./Modules/_posixsubprocess.c", "uriBaseId": "PWD"}, "region": {"startLine": 1030, "startColumn": 5, "endColumn": 15}, "contextRegion": {"startLine": 1030, "snippet": {"text": "    Py_ssize_t extra_group_size = -2;\n"}}}, "logicalLocations": [{"name": "subprocess_fork_exec_impl", "fullyQualifiedName": "subprocess_fork_exec_impl", "decoratedName": "subprocess_fork_exec_impl", "kind": "function"}], "message": {"text": "...to here"}}, "kinds": ["branch", "false"], "nestingLevel": 1}, {"location": {"physicalLocation": {"artifactLocation": {"uri": "./Modules/_posixsubprocess.c", "uriBaseId": "PWD"}, "region": {"startLine": 1032, "startColumn": 8, "endColumn": 9}, "contextRegion": {"startLine": 1032, "snippet": {"text": "    if (extra_groups_packed != Py_None) {\n"}}}, "logicalLocations": [{"name": "subprocess_fork_exec_impl", "fullyQualifiedName": "subprocess_fork_exec_impl", "decoratedName": "subprocess_fork_exec_impl", "kind": "function"}], "message": {"text": "following 'false' branch..."}}, "kinds": ["branch", "false"], "nestingLevel": 1}, {"location": {"physicalLocation": {"artifactLocation": {"uri": "./Modules/_posixsubprocess.c", "uriBaseId": "PWD"}, "region": {"startLine": 1087, "startColumn": 5, "endColumn": 10}, "contextRegion": {"startLine": 1087, "snippet": {"text": "    gid_t gid = (gid_t)-1;\n"}}}, "logicalLocations": [{"name": "subprocess_fork_exec_impl", "fullyQualifiedName": "subprocess_fork_exec_impl", "decoratedName": "subprocess_fork_exec_impl", "kind": "function"}], "message": {"text": "...to here"}}, "kinds": ["branch", "false"], "nestingLevel": 1}, {"location": {"physicalLocation": {"artifactLocation": {"uri": "./Modules/_posixsubprocess.c", "uriBaseId": "PWD"}, "region": {"startLine": 1112, "startColumn": 8, "endColumn": 9}, "contextRegion": {"startLine": 1112, "snippet": {"text": "    if (c_fds_to_keep == NULL) {\n"}}}, "logicalLocations": [{"name": "subprocess_fork_exec_impl", "fullyQualifiedName": "subprocess_fork_exec_impl", "decoratedName": "subprocess_fork_exec_impl", "kind": "function"}], "message": {"text": "following 'false' branch (when 'c_fds_to_keep' is non-NULL)..."}}, "kinds": ["branch", "false"], "nestingLevel": 1}, {"location": {"physicalLocation": {"artifactLocation": {"uri": "./Modules/_posixsubprocess.c", "uriBaseId": "PWD"}, "region": {"startLine": 1116, "startColumn": 5, "endColumn": 7}, "contextRegion": {"startLine": 1116, "snippet": {"text": "    if (convert_fds_to_keep_to_c(py_fds_to_keep, c_fds_to_keep) < 0) {\n"}}}, "logicalLocations": [{"name": "subprocess_fork_exec_impl", "fullyQualifiedName": "subprocess_fork_exec_impl", "decoratedName": "subprocess_fork_exec_impl", "kind": "function"}], "message": {"text": "...to here"}}, "kinds": ["branch", "false"], "nestingLevel": 1}, {"location": {"physicalLocation": {"artifactLocation": {"uri": "./Modules/_posixsubprocess.c", "uriBaseId": "PWD"}, "region": {"startLine": 1116, "startColumn": 8, "endColumn": 9}, "contextRegion": {"startLine": 1116, "snippet": {"text": "    if (convert_fds_to_keep_to_c(py_fds_to_keep, c_fds_to_keep) < 0) {\n"}}}, "logicalLocations": [{"name": "subprocess_fork_exec_impl", "fullyQualifiedName": "subprocess_fork_exec_impl", "decoratedName": "subprocess_fork_exec_impl", "kind": "function"}], "message": {"text": "following 'false' branch..."}}, "kinds": ["branch", "false"], "nestingLevel": 1}, {"location": {"physicalLocation": {"artifactLocation": {"uri": "./Modules/_posixsubprocess.c", "uriBaseId": "PWD"}, "region": {"startLine": 1123, "startColumn": 5, "endColumn": 7}, "contextRegion": {"startLine": 1123, "snippet": {"text": "    if (preexec_fn != Py_None) {\n"}}}, "logicalLocations": [{"name": "subprocess_fork_exec_impl", "fullyQualifiedName": "subprocess_fork_exec_impl", "decoratedName": "subprocess_fork_exec_impl", "kind": "function"}], "message": {"text": "...to here"}}, "kinds": ["branch", "false"], "nestingLevel": 1}, {"location": {"physicalLocation": {"artifactLocation": {"uri": "./Modules/_posixsubprocess.c", "uriBaseId": "PWD"}, "region": {"startLine": 1123, "startColumn": 8, "endColumn": 9}, "contextRegion": {"startLine": 1123, "snippet": {"text": "    if (preexec_fn != Py_None) {\n"}}}, "logicalLocations": [{"name": "subprocess_fork_exec_impl", "fullyQualifiedName": "subprocess_fork_exec_impl", "decoratedName": "subprocess_fork_exec_impl", "kind": "function"}], "message": {"text": "following 'false' branch..."}}, "kinds": ["branch", "false"], "nestingLevel": 1}, {"location": {"physicalLocation": {"artifactLocation": {"uri": "./Modules/_posixsubprocess.c", "uriBaseId": "PWD"}, "region": {"startLine": 1132, "startColumn": 5, "endColumn": 10}, "contextRegion": {"startLine": 1132, "snippet": {"text": "    const void *old_sigmask = NULL;\n"}}}, "logicalLocations": [{"name": "subprocess_fork_exec_impl", "fullyQualifiedName": "subprocess_fork_exec_impl", "decoratedName": "subprocess_fork_exec_impl", "kind": "function"}], "message": {"text": "...to here"}}, "kinds": ["branch", "false"], "nestingLevel": 1}, {"location": {"physicalLocation": {"artifactLocation": {"uri": "./Modules/_posixsubprocess.c", "uriBaseId": "PWD"}, "region": {"startLine": 1156, "startColumn": 11, "endLine": 1163, "endColumn": 58}, "contextRegion": {"startLine": 1156, "endLine": 1163, "snippet": {"text": "    pid = do_fork_exec(exec_array, argv, envp, cwd,\n                       p2cread, p2cwrite, c2pread, c2pwrite,\n                       errread, errwrite, errpipe_read, errpipe_write,\n                       close_fds, restore_signals, call_setsid, pgid_to_set,\n                       gid, extra_group_size, extra_groups,\n                       uid, child_umask, old_sigmask,\n                       c_fds_to_keep, fds_to_keep_len,\n                       preexec_fn, preexec_fn_args_tuple);\n"}}}, "logicalLocations": [{"name": "subprocess_fork_exec_impl", "fullyQualifiedName": "subprocess_fork_exec_impl", "decoratedName": "subprocess_fork_exec_impl", "kind": "function"}], "message": {"text": "calling 'do_fork_exec' from 'subprocess_fork_exec_impl'"}}, "kinds": ["call", "function"], "nestingLevel": 1}, {"location": {"physicalLocation": {"artifactLocation": {"uri": "./Modules/_posixsubprocess.c", "uriBaseId": "PWD"}, "region": {"startLine": 783, "startColumn": 1, "endColumn": 13}, "contextRegion": {"startLine": 783, "snippet": {"text": "do_fork_exec(char *const exec_array[],\n"}}}, "logicalLocations": [{"name": "do_fork_exec", "fullyQualifiedName": "do_fork_exec", "decoratedName": "do_fork_exec", "kind": "function"}], "message": {"text": "entry to 'do_fork_exec'"}}, "kinds": ["enter", "function"], "nestingLevel": 2}, {"location": {"physicalLocation": {"artifactLocation": {"uri": "./Modules/_posixsubprocess.c", "uriBaseId": "PWD"}, "region": {"startLine": 806, "startColumn": 8, "endColumn": 9}, "contextRegion": {"startLine": 806, "snippet": {"text": "    if (child_sigmask) {\n"}}}, "logicalLocations": [{"name": "do_fork_exec", "fullyQualifiedName": "do_fork_exec", "decoratedName": "do_fork_exec", "kind": "function"}], "message": {"text": "following 'false' branch (when 'child_sigmask' is NULL)..."}}, "kinds": ["branch", "false"], "nestingLevel": 2}, {"location": {"physicalLocation": {"artifactLocation": {"uri": "./Modules/_posixsubprocess.c", "uriBaseId": "PWD"}, "region": {"startLine": 838, "startColumn": 9, "endColumn": 12}, "contextRegion": {"startLine": 838, "snippet": {"text": "        pid = fork();\n"}}}, "logicalLocations": [{"name": "do_fork_exec", "fullyQualifiedName": "do_fork_exec", "decoratedName": "do_fork_exec", "kind": "function"}], "message": {"text": "...to here"}}, "kinds": ["branch", "false"], "nestingLevel": 2}, {"location": {"physicalLocation": {"artifactLocation": {"uri": "./Modules/_posixsubprocess.c", "uriBaseId": "PWD"}, "region": {"startLine": 841, "startColumn": 8, "endColumn": 9}, "contextRegion": {"startLine": 841, "snippet": {"text": "    if (pid != 0) {\n"}}}, "logicalLocations": [{"name": "do_fork_exec", "fullyQualifiedName": "do_fork_exec", "decoratedName": "do_fork_exec", "kind": "function"}], "message": {"text": "following 'false' branch (when 'pid == 0')..."}}, "kinds": ["branch", "false"], "nestingLevel": 2}, {"location": {"physicalLocation": {"artifactLocation": {"uri": "./Modules/_posixsubprocess.c", "uriBaseId": "PWD"}, "region": {"startLine": 851, "startColumn": 5, "endColumn": 7}, "contextRegion": {"startLine": 851, "snippet": {"text": "    if (preexec_fn != Py_None) {\n"}}}, "logicalLocations": [{"name": "do_fork_exec", "fullyQualifiedName": "do_fork_exec", "decoratedName": "do_fork_exec", "kind": "function"}], "message": {"text": "...to here"}}, "kinds": ["branch", "false"], "nestingLevel": 2}, {"location": {"physicalLocation": {"artifactLocation": {"uri": "./Modules/_posixsubprocess.c", "uriBaseId": "PWD"}, "region": {"startLine": 859, "startColumn": 5, "endLine": 866, "endColumn": 50}, "contextRegion": {"startLine": 859, "endLine": 866, "snippet": {"text": "    child_exec(exec_array, argv, envp, cwd,\n               p2cread, p2cwrite, c2pread, c2pwrite,\n               errread, errwrite, errpipe_read, errpipe_write,\n               close_fds, restore_signals, call_setsid, pgid_to_set,\n               gid, extra_group_size, extra_groups,\n               uid, child_umask, child_sigmask,\n               fds_to_keep, fds_to_keep_len,\n               preexec_fn, preexec_fn_args_tuple);\n"}}}, "logicalLocations": [{"name": "do_fork_exec", "fullyQualifiedName": "do_fork_exec", "decoratedName": "do_fork_exec", "kind": "function"}], "message": {"text": "calling 'child_exec' from 'do_fork_exec'"}}, "kinds": ["call", "function"], "nestingLevel": 2}, {"location": {"physicalLocation": {"artifactLocation": {"uri": "./Modules/_posixsubprocess.c", "uriBaseId": "PWD"}, "region": {"startLine": 574, "startColumn": 1, "endColumn": 11}, "contextRegion": {"startLine": 574, "snippet": {"text": "child_exec(char *const exec_array[],\n"}}}, "logicalLocations": [{"name": "child_exec", "fullyQualifiedName": "child_exec", "decoratedName": "child_exec", "kind": "function"}], "message": {"text": "entry to 'child_exec'"}}, "kinds": ["enter", "function"], "nestingLevel": 3}, {"location": {"physicalLocation": {"artifactLocation": {"uri": "./Modules/_posixsubprocess.c", "uriBaseId": "PWD"}, "region": {"startLine": 599, "startColumn": 8, "endColumn": 9}, "contextRegion": {"startLine": 599, "snippet": {"text": "    if (make_inheritable(fds_to_keep, fds_to_keep_len, errpipe_write) < 0)\n"}}}, "logicalLocations": [{"name": "child_exec", "fullyQualifiedName": "child_exec", "decoratedName": "child_exec", "kind": "function"}], "message": {"text": "following 'false' branch..."}}, "kinds": ["branch", "false"], "nestingLevel": 3}, {"location": {"physicalLocation": {"artifactLocation": {"uri": "./Modules/_posixsubprocess.c", "uriBaseId": "PWD"}, "region": {"startLine": 603, "startColumn": 5, "endColumn": 7}, "contextRegion": {"startLine": 603, "snippet": {"text": "    if (p2cwrite != -1)\n"}}}, "logicalLocations": [{"name": "child_exec", "fullyQualifiedName": "child_exec", "decoratedName": "child_exec", "kind": "function"}], "message": {"text": "...to here"}}, "kinds": ["branch", "false"], "nestingLevel": 3}, {"location": {"physicalLocation": {"artifactLocation": {"uri": "./Modules/_posixsubprocess.c", "uriBaseId": "PWD"}, "region": {"startLine": 603, "startColumn": 8, "endColumn": 9}, "contextRegion": {"startLine": 603, "snippet": {"text": "    if (p2cwrite != -1)\n"}}}, "logicalLocations": [{"name": "child_exec", "fullyQualifiedName": "child_exec", "decoratedName": "child_exec", "kind": "function"}], "message": {"text": "following 'false' branch (when 'p2cwrite == -1')..."}}, "kinds": ["branch", "false"], "nestingLevel": 3}, {"location": {"physicalLocation": {"artifactLocation": {"uri": "./Modules/_posixsubprocess.c", "uriBaseId": "PWD"}, "region": {"startLine": 604, "startColumn": 9, "endColumn": 10}, "contextRegion": {"startLine": 604, "snippet": {"text": "        POSIX_CALL(close(p2cwrite));\n"}}}, "logicalLocations": [{"name": "child_exec", "fullyQualifiedName": "child_exec", "decoratedName": "child_exec", "kind": "function"}], "message": {"text": "...to here"}}, "kinds": ["branch", "false"], "nestingLevel": 3}, {"location": {"physicalLocation": {"artifactLocation": {"uri": "./Modules/_posixsubprocess.c", "uriBaseId": "PWD"}, "region": {"startLine": 605, "startColumn": 8, "endColumn": 9}, "contextRegion": {"startLine": 605, "snippet": {"text": "    if (c2pread != -1)\n"}}}, "logicalLocations": [{"name": "child_exec", "fullyQualifiedName": "child_exec", "decoratedName": "child_exec", "kind": "function"}], "message": {"text": "following 'false' branch (when 'c2pread == -1')..."}}, "kinds": ["branch", "false"], "nestingLevel": 3}, {"location": {"physicalLocation": {"artifactLocation": {"uri": "./Modules/_posixsubprocess.c", "uriBaseId": "PWD"}, "region": {"startLine": 606, "startColumn": 9, "endColumn": 10}, "contextRegion": {"startLine": 606, "snippet": {"text": "        POSIX_CALL(close(c2pread));\n"}}}, "logicalLocations": [{"name": "child_exec", "fullyQualifiedName": "child_exec", "decoratedName": "child_exec", "kind": "function"}], "message": {"text": "...to here"}}, "kinds": ["branch", "false"], "nestingLevel": 3}, {"location": {"physicalLocation": {"artifactLocation": {"uri": "./Modules/_posixsubprocess.c", "uriBaseId": "PWD"}, "region": {"startLine": 607, "startColumn": 8, "endColumn": 9}, "contextRegion": {"startLine": 607, "snippet": {"text": "    if (errread != -1)\n"}}}, "logicalLocations": [{"name": "child_exec", "fullyQualifiedName": "child_exec", "decoratedName": "child_exec", "kind": "function"}], "message": {"text": "following 'false' branch (when 'errread == -1')..."}}, "kinds": ["branch", "false"], "nestingLevel": 3}, {"location": {"physicalLocation": {"artifactLocation": {"uri": "./Modules/_posixsubprocess.c", "uriBaseId": "PWD"}, "region": {"startLine": 608, "startColumn": 9, "endColumn": 10}, "contextRegion": {"startLine": 608, "snippet": {"text": "        POSIX_CALL(close(errread));\n"}}}, "logicalLocations": [{"name": "child_exec", "fullyQualifiedName": "child_exec", "decoratedName": "child_exec", "kind": "function"}], "message": {"text": "...to here"}}, "kinds": ["branch", "false"], "nestingLevel": 3}, {"location": {"physicalLocation": {"artifactLocation": {"uri": "./Modules/_posixsubprocess.c", "uriBaseId": "PWD"}, "region": {"startLine": 609, "startColumn": 5, "endColumn": 6}, "contextRegion": {"startLine": 609, "snippet": {"text": "    POSIX_CALL(close(errpipe_read));\n"}}}, "logicalLocations": [{"name": "child_exec", "fullyQualifiedName": "child_exec", "decoratedName": "child_exec", "kind": "function"}], "message": {"text": "following 'false' branch..."}}, "kinds": ["branch", "false"], "nestingLevel": 3}, {"location": {"physicalLocation": {"artifactLocation": {"uri": "./Modules/_posixsubprocess.c", "uriBaseId": "PWD"}, "region": {"startLine": 609, "startColumn": 5, "endColumn": 6}, "contextRegion": {"startLine": 609, "snippet": {"text": "    POSIX_CALL(close(errpipe_read));\n"}}}, "logicalLocations": [{"name": "child_exec", "fullyQualifiedName": "child_exec", "decoratedName": "child_exec", "kind": "function"}], "message": {"text": "...to here"}}, "kinds": ["branch", "false"], "nestingLevel": 3}, {"location": {"physicalLocation": {"artifactLocation": {"uri": "./Modules/_posixsubprocess.c", "uriBaseId": "PWD"}, "region": {"startLine": 620, "startColumn": 12, "endColumn": 42}, "contextRegion": {"startLine": 620, "snippet": {"text": "    while (errwrite == 0 || errwrite == 1) {\n"}}}, "logicalLocations": [{"name": "child_exec", "fullyQualifiedName": "child_exec", "decoratedName": "child_exec", "kind": "function"}], "message": {"text": "following 'false' branch..."}}, "kinds": ["branch", "false"], "nestingLevel": 3}, {"location": {"physicalLocation": {"artifactLocation": {"uri": "./Modules/_posixsubprocess.c", "uriBaseId": "PWD"}, "region": {"startLine": 631, "startColumn": 5, "endColumn": 7}, "contextRegion": {"startLine": 631, "snippet": {"text": "    if (p2cread == 0) {\n"}}}, "logicalLocations": [{"name": "child_exec", "fullyQualifiedName": "child_exec", "decoratedName": "child_exec", "kind": "function"}], "message": {"text": "...to here"}}, "kinds": ["branch", "false"], "nestingLevel": 3}, {"location": {"physicalLocation": {"artifactLocation": {"uri": "./Modules/_posixsubprocess.c", "uriBaseId": "PWD"}, "region": {"startLine": 632, "startColumn": 12, "endColumn": 13}, "contextRegion": {"startLine": 632, "snippet": {"text": "        if (_Py_set_inheritable_async_safe(p2cread, 1, NULL) < 0)\n"}}}, "logicalLocations": [{"name": "child_exec", "fullyQualifiedName": "child_exec", "decoratedName": "child_exec", "kind": "function"}], "message": {"text": "following 'false' branch..."}}, "kinds": ["branch", "false"], "nestingLevel": 3}, {"location": {"physicalLocation": {"artifactLocation": {"uri": "./Modules/_posixsubprocess.c", "uriBaseId": "PWD"}, "region": {"startLine": 636, "startColumn": 9, "endColumn": 10}, "contextRegion": {"startLine": 636, "snippet": {"text": "        POSIX_CALL(dup2(p2cread, 0));  /* stdin */\n"}}}, "logicalLocations": [{"name": "child_exec", "fullyQualifiedName": "child_exec", "decoratedName": "child_exec", "kind": "function"}], "message": {"text": "...to here"}}, "kinds": ["branch", "false"], "nestingLevel": 3}, {"location": {"physicalLocation": {"artifactLocation": {"uri": "./Modules/_posixsubprocess.c", "uriBaseId": "PWD"}, "region": {"startLine": 638, "startColumn": 8, "endColumn": 9}, "contextRegion": {"startLine": 638, "snippet": {"text": "    if (c2pwrite == 1) {\n"}}}, "logicalLocations": [{"name": "child_exec", "fullyQualifiedName": "child_exec", "decoratedName": "child_exec", "kind": "function"}], "message": {"text": "following 'false' branch (when 'c2pwrite != 1')..."}}, "kinds": ["branch", "false"], "nestingLevel": 3}, {"location": {"physicalLocation": {"artifactLocation": {"uri": "./Modules/_posixsubprocess.c", "uriBaseId": "PWD"}, "region": {"startLine": 642, "startColumn": 10, "endColumn": 12}, "contextRegion": {"startLine": 642, "snippet": {"text": "    else if (c2pwrite != -1)\n"}}}, "logicalLocations": [{"name": "child_exec", "fullyQualifiedName": "child_exec", "decoratedName": "child_exec", "kind": "function"}], "message": {"text": "...to here"}}, "kinds": ["branch", "false"], "nestingLevel": 3}, {"location": {"physicalLocation": {"artifactLocation": {"uri": "./Modules/_posixsubprocess.c", "uriBaseId": "PWD"}, "region": {"startLine": 642, "startColumn": 13, "endColumn": 14}, "contextRegion": {"startLine": 642, "snippet": {"text": "    else if (c2pwrite != -1)\n"}}}, "logicalLocations": [{"name": "child_exec", "fullyQualifiedName": "child_exec", "decoratedName": "child_exec", "kind": "function"}], "message": {"text": "following 'true' branch (when 'c2pwrite != -1')..."}}, "kinds": ["branch", "true"], "nestingLevel": 3}, {"location": {"physicalLocation": {"artifactLocation": {"uri": "./Modules/_posixsubprocess.c", "uriBaseId": "PWD"}, "region": {"startLine": 643, "startColumn": 9, "endColumn": 10}, "contextRegion": {"startLine": 643, "snippet": {"text": "        POSIX_CALL(dup2(c2pwrite, 1));  /* stdout */\n"}}}, "logicalLocations": [{"name": "child_exec", "fullyQualifiedName": "child_exec", "decoratedName": "child_exec", "kind": "function"}], "message": {"text": "...to here"}}, "kinds": ["branch", "true"], "nestingLevel": 3}, {"location": {"physicalLocation": {"artifactLocation": {"uri": "./Modules/_posixsubprocess.c", "uriBaseId": "PWD"}, "region": {"startLine": 643, "startColumn": 9, "endColumn": 10}, "contextRegion": {"startLine": 643, "snippet": {"text": "        POSIX_CALL(dup2(c2pwrite, 1));  /* stdout */\n"}}}, "logicalLocations": [{"name": "child_exec", "fullyQualifiedName": "child_exec", "decoratedName": "child_exec", "kind": "function"}], "message": {"text": "opened here"}}, "kinds": ["acquire", "resource"], "nestingLevel": 3}, {"location": {"physicalLocation": {"artifactLocation": {"uri": "./Modules/_posixsubprocess.c", "uriBaseId": "PWD"}, "region": {"startLine": 643, "startColumn": 9, "endColumn": 10}, "contextRegion": {"startLine": 643, "snippet": {"text": "        POSIX_CALL(dup2(c2pwrite, 1));  /* stdout */\n"}}}, "logicalLocations": [{"name": "child_exec", "fullyQualifiedName": "child_exec", "decoratedName": "child_exec", "kind": "function"}], "message": {"text": "'dup2(c2pwrite, 1)' leaks here; was opened at (48)"}}, "kinds": ["danger"], "nestingLevel": 3}]}]}]}, {"ruleId": "-Wanalyzer-fd-leak", "taxa": [{"id": "775", "toolComponent": {"name": "cwe"}}], "level": "warning", "message": {"text": "leak of file descriptor 'dup2(errwrite, 2)'"}, "locations": [{"physicalLocation": {"artifactLocation": {"uri": "./Modules/_posixsubprocess.c", "uriBaseId": "PWD"}, "region": {"startLine": 650, "startColumn": 9, "endColumn": 10}, "contextRegion": {"startLine": 650, "snippet": {"text": "        POSIX_CALL(dup2(errwrite, 2));  /* stderr */\n"}}}, "logicalLocations": [{"name": "child_exec", "fullyQualifiedName": "child_exec", "decoratedName": "child_exec", "kind": "function"}]}], "codeFlows": [{"threadFlows": [{"locations": [{"location": {"physicalLocation": {"artifactLocation": {"uri": "./Modules/_posixsubprocess.c", "uriBaseId": "PWD"}, "region": {"startLine": 922, "startColumn": 1, "endColumn": 26}, "contextRegion": {"startLine": 922, "snippet": {"text": "subprocess_fork_exec_impl(PyObject *module, PyObject *process_args,\n"}}}, "logicalLocations": [{"name": "subprocess_fork_exec_impl", "fullyQualifiedName": "subprocess_fork_exec_impl", "decoratedName": "subprocess_fork_exec_impl", "kind": "function"}], "message": {"text": "entry to 'subprocess_fork_exec_impl'"}}, "kinds": ["enter", "function"], "nestingLevel": 1}, {"location": {"physicalLocation": {"artifactLocation": {"uri": "./Modules/_posixsubprocess.c", "uriBaseId": "PWD"}, "region": {"startLine": 962, "startColumn": 8, "endColumn": 9}, "contextRegion": {"startLine": 962, "snippet": {"text": "    if (close_fds && errpipe_write < 3) {  /* precondition */\n"}}}, "logicalLocations": [{"name": "subprocess_fork_exec_impl", "fullyQualifiedName": "subprocess_fork_exec_impl", "decoratedName": "subprocess_fork_exec_impl", "kind": "function"}], "message": {"text": "following 'false' branch..."}}, "kinds": ["branch", "false"], "nestingLevel": 1}, {"location": {"physicalLocation": {"artifactLocation": {"uri": "./Modules/_posixsubprocess.c", "uriBaseId": "PWD"}, "region": {"startLine": 966, "startColumn": 5, "endColumn": 7}, "contextRegion": {"startLine": 966, "snippet": {"text": "    if (_sanity_check_python_fd_sequence(py_fds_to_keep)) {\n"}}}, "logicalLocations": [{"name": "subprocess_fork_exec_impl", "fullyQualifiedName": "subprocess_fork_exec_impl", "decoratedName": "subprocess_fork_exec_impl", "kind": "function"}], "message": {"text": "...to here"}}, "kinds": ["branch", "false"], "nestingLevel": 1}, {"location": {"physicalLocation": {"artifactLocation": {"uri": "./Modules/_posixsubprocess.c", "uriBaseId": "PWD"}, "region": {"startLine": 966, "startColumn": 8, "endColumn": 9}, "contextRegion": {"startLine": 966, "snippet": {"text": "    if (_sanity_check_python_fd_sequence(py_fds_to_keep)) {\n"}}}, "logicalLocations": [{"name": "subprocess_fork_exec_impl", "fullyQualifiedName": "subprocess_fork_exec_impl", "decoratedName": "subprocess_fork_exec_impl", "kind": "function"}], "message": {"text": "following 'false' branch..."}}, "kinds": ["branch", "false"], "nestingLevel": 1}, {"location": {"physicalLocation": {"artifactLocation": {"uri": "./Modules/_posixsubprocess.c", "uriBaseId": "PWD"}, "region": {"startLine": 972, "startColumn": 5, "endColumn": 7}, "contextRegion": {"startLine": 972, "snippet": {"text": "    if (preexec_fn != Py_None) {\n"}}}, "logicalLocations": [{"name": "subprocess_fork_exec_impl", "fullyQualifiedName": "subprocess_fork_exec_impl", "decoratedName": "subprocess_fork_exec_impl", "kind": "function"}], "message": {"text": "...to here"}}, "kinds": ["branch", "false"], "nestingLevel": 1}, {"location": {"physicalLocation": {"artifactLocation": {"uri": "./Modules/_posixsubprocess.c", "uriBaseId": "PWD"}, "region": {"startLine": 977, "startColumn": 8, "endColumn": 9}, "contextRegion": {"startLine": 977, "snippet": {"text": "    if (!exec_array)\n"}}}, "logicalLocations": [{"name": "subprocess_fork_exec_impl", "fullyQualifiedName": "subprocess_fork_exec_impl", "decoratedName": "subprocess_fork_exec_impl", "kind": "function"}], "message": {"text": "following 'false' branch (when 'exec_array' is non-NULL)..."}}, "kinds": ["branch", "false"], "nestingLevel": 1}, {"location": {"physicalLocation": {"artifactLocation": {"uri": "./Modules/_posixsubprocess.c", "uriBaseId": "PWD"}, "region": {"startLine": 983, "startColumn": 5, "endColumn": 7}, "contextRegion": {"startLine": 983, "snippet": {"text": "    if (process_args != Py_None) {\n"}}}, "logicalLocations": [{"name": "subprocess_fork_exec_impl", "fullyQualifiedName": "subprocess_fork_exec_impl", "decoratedName": "subprocess_fork_exec_impl", "kind": "function"}], "message": {"text": "...to here"}}, "kinds": ["branch", "false"], "nestingLevel": 1}, {"location": {"physicalLocation": {"artifactLocation": {"uri": "./Modules/_posixsubprocess.c", "uriBaseId": "PWD"}, "region": {"startLine": 983, "startColumn": 8, "endColumn": 9}, "contextRegion": {"startLine": 983, "snippet": {"text": "    if (process_args != Py_None) {\n"}}}, "logicalLocations": [{"name": "subprocess_fork_exec_impl", "fullyQualifiedName": "subprocess_fork_exec_impl", "decoratedName": "subprocess_fork_exec_impl", "kind": "function"}], "message": {"text": "following 'false' branch..."}}, "kinds": ["branch", "false"], "nestingLevel": 1}, {"location": {"physicalLocation": {"artifactLocation": {"uri": "./Modules/_posixsubprocess.c", "uriBaseId": "PWD"}, "region": {"startLine": 1013, "startColumn": 5, "endColumn": 7}, "contextRegion": {"startLine": 1013, "snippet": {"text": "    if (env_list != Py_None) {\n"}}}, "logicalLocations": [{"name": "subprocess_fork_exec_impl", "fullyQualifiedName": "subprocess_fork_exec_impl", "decoratedName": "subprocess_fork_exec_impl", "kind": "function"}], "message": {"text": "...to here"}}, "kinds": ["branch", "false"], "nestingLevel": 1}, {"location": {"physicalLocation": {"artifactLocation": {"uri": "./Modules/_posixsubprocess.c", "uriBaseId": "PWD"}, "region": {"startLine": 1013, "startColumn": 8, "endColumn": 9}, "contextRegion": {"startLine": 1013, "snippet": {"text": "    if (env_list != Py_None) {\n"}}}, "logicalLocations": [{"name": "subprocess_fork_exec_impl", "fullyQualifiedName": "subprocess_fork_exec_impl", "decoratedName": "subprocess_fork_exec_impl", "kind": "function"}], "message": {"text": "following 'false' branch..."}}, "kinds": ["branch", "false"], "nestingLevel": 1}, {"location": {"physicalLocation": {"artifactLocation": {"uri": "./Modules/_posixsubprocess.c", "uriBaseId": "PWD"}, "region": {"startLine": 1019, "startColumn": 5, "endColumn": 7}, "contextRegion": {"startLine": 1019, "snippet": {"text": "    if (cwd_obj != Py_None) {\n"}}}, "logicalLocations": [{"name": "subprocess_fork_exec_impl", "fullyQualifiedName": "subprocess_fork_exec_impl", "decoratedName": "subprocess_fork_exec_impl", "kind": "function"}], "message": {"text": "...to here"}}, "kinds": ["branch", "false"], "nestingLevel": 1}, {"location": {"physicalLocation": {"artifactLocation": {"uri": "./Modules/_posixsubprocess.c", "uriBaseId": "PWD"}, "region": {"startLine": 1019, "startColumn": 8, "endColumn": 9}, "contextRegion": {"startLine": 1019, "snippet": {"text": "    if (cwd_obj != Py_None) {\n"}}}, "logicalLocations": [{"name": "subprocess_fork_exec_impl", "fullyQualifiedName": "subprocess_fork_exec_impl", "decoratedName": "subprocess_fork_exec_impl", "kind": "function"}], "message": {"text": "following 'false' branch..."}}, "kinds": ["branch", "false"], "nestingLevel": 1}, {"location": {"physicalLocation": {"artifactLocation": {"uri": "./Modules/_posixsubprocess.c", "uriBaseId": "PWD"}, "region": {"startLine": 1030, "startColumn": 5, "endColumn": 15}, "contextRegion": {"startLine": 1030, "snippet": {"text": "    Py_ssize_t extra_group_size = -2;\n"}}}, "logicalLocations": [{"name": "subprocess_fork_exec_impl", "fullyQualifiedName": "subprocess_fork_exec_impl", "decoratedName": "subprocess_fork_exec_impl", "kind": "function"}], "message": {"text": "...to here"}}, "kinds": ["branch", "false"], "nestingLevel": 1}, {"location": {"physicalLocation": {"artifactLocation": {"uri": "./Modules/_posixsubprocess.c", "uriBaseId": "PWD"}, "region": {"startLine": 1032, "startColumn": 8, "endColumn": 9}, "contextRegion": {"startLine": 1032, "snippet": {"text": "    if (extra_groups_packed != Py_None) {\n"}}}, "logicalLocations": [{"name": "subprocess_fork_exec_impl", "fullyQualifiedName": "subprocess_fork_exec_impl", "decoratedName": "subprocess_fork_exec_impl", "kind": "function"}], "message": {"text": "following 'false' branch..."}}, "kinds": ["branch", "false"], "nestingLevel": 1}, {"location": {"physicalLocation": {"artifactLocation": {"uri": "./Modules/_posixsubprocess.c", "uriBaseId": "PWD"}, "region": {"startLine": 1087, "startColumn": 5, "endColumn": 10}, "contextRegion": {"startLine": 1087, "snippet": {"text": "    gid_t gid = (gid_t)-1;\n"}}}, "logicalLocations": [{"name": "subprocess_fork_exec_impl", "fullyQualifiedName": "subprocess_fork_exec_impl", "decoratedName": "subprocess_fork_exec_impl", "kind": "function"}], "message": {"text": "...to here"}}, "kinds": ["branch", "false"], "nestingLevel": 1}, {"location": {"physicalLocation": {"artifactLocation": {"uri": "./Modules/_posixsubprocess.c", "uriBaseId": "PWD"}, "region": {"startLine": 1112, "startColumn": 8, "endColumn": 9}, "contextRegion": {"startLine": 1112, "snippet": {"text": "    if (c_fds_to_keep == NULL) {\n"}}}, "logicalLocations": [{"name": "subprocess_fork_exec_impl", "fullyQualifiedName": "subprocess_fork_exec_impl", "decoratedName": "subprocess_fork_exec_impl", "kind": "function"}], "message": {"text": "following 'false' branch (when 'c_fds_to_keep' is non-NULL)..."}}, "kinds": ["branch", "false"], "nestingLevel": 1}, {"location": {"physicalLocation": {"artifactLocation": {"uri": "./Modules/_posixsubprocess.c", "uriBaseId": "PWD"}, "region": {"startLine": 1116, "startColumn": 5, "endColumn": 7}, "contextRegion": {"startLine": 1116, "snippet": {"text": "    if (convert_fds_to_keep_to_c(py_fds_to_keep, c_fds_to_keep) < 0) {\n"}}}, "logicalLocations": [{"name": "subprocess_fork_exec_impl", "fullyQualifiedName": "subprocess_fork_exec_impl", "decoratedName": "subprocess_fork_exec_impl", "kind": "function"}], "message": {"text": "...to here"}}, "kinds": ["branch", "false"], "nestingLevel": 1}, {"location": {"physicalLocation": {"artifactLocation": {"uri": "./Modules/_posixsubprocess.c", "uriBaseId": "PWD"}, "region": {"startLine": 1116, "startColumn": 8, "endColumn": 9}, "contextRegion": {"startLine": 1116, "snippet": {"text": "    if (convert_fds_to_keep_to_c(py_fds_to_keep, c_fds_to_keep) < 0) {\n"}}}, "logicalLocations": [{"name": "subprocess_fork_exec_impl", "fullyQualifiedName": "subprocess_fork_exec_impl", "decoratedName": "subprocess_fork_exec_impl", "kind": "function"}], "message": {"text": "following 'false' branch..."}}, "kinds": ["branch", "false"], "nestingLevel": 1}, {"location": {"physicalLocation": {"artifactLocation": {"uri": "./Modules/_posixsubprocess.c", "uriBaseId": "PWD"}, "region": {"startLine": 1123, "startColumn": 5, "endColumn": 7}, "contextRegion": {"startLine": 1123, "snippet": {"text": "    if (preexec_fn != Py_None) {\n"}}}, "logicalLocations": [{"name": "subprocess_fork_exec_impl", "fullyQualifiedName": "subprocess_fork_exec_impl", "decoratedName": "subprocess_fork_exec_impl", "kind": "function"}], "message": {"text": "...to here"}}, "kinds": ["branch", "false"], "nestingLevel": 1}, {"location": {"physicalLocation": {"artifactLocation": {"uri": "./Modules/_posixsubprocess.c", "uriBaseId": "PWD"}, "region": {"startLine": 1123, "startColumn": 8, "endColumn": 9}, "contextRegion": {"startLine": 1123, "snippet": {"text": "    if (preexec_fn != Py_None) {\n"}}}, "logicalLocations": [{"name": "subprocess_fork_exec_impl", "fullyQualifiedName": "subprocess_fork_exec_impl", "decoratedName": "subprocess_fork_exec_impl", "kind": "function"}], "message": {"text": "following 'false' branch..."}}, "kinds": ["branch", "false"], "nestingLevel": 1}, {"location": {"physicalLocation": {"artifactLocation": {"uri": "./Modules/_posixsubprocess.c", "uriBaseId": "PWD"}, "region": {"startLine": 1132, "startColumn": 5, "endColumn": 10}, "contextRegion": {"startLine": 1132, "snippet": {"text": "    const void *old_sigmask = NULL;\n"}}}, "logicalLocations": [{"name": "subprocess_fork_exec_impl", "fullyQualifiedName": "subprocess_fork_exec_impl", "decoratedName": "subprocess_fork_exec_impl", "kind": "function"}], "message": {"text": "...to here"}}, "kinds": ["branch", "false"], "nestingLevel": 1}, {"location": {"physicalLocation": {"artifactLocation": {"uri": "./Modules/_posixsubprocess.c", "uriBaseId": "PWD"}, "region": {"startLine": 1156, "startColumn": 11, "endLine": 1163, "endColumn": 58}, "contextRegion": {"startLine": 1156, "endLine": 1163, "snippet": {"text": "    pid = do_fork_exec(exec_array, argv, envp, cwd,\n                       p2cread, p2cwrite, c2pread, c2pwrite,\n                       errread, errwrite, errpipe_read, errpipe_write,\n                       close_fds, restore_signals, call_setsid, pgid_to_set,\n                       gid, extra_group_size, extra_groups,\n                       uid, child_umask, old_sigmask,\n                       c_fds_to_keep, fds_to_keep_len,\n                       preexec_fn, preexec_fn_args_tuple);\n"}}}, "logicalLocations": [{"name": "subprocess_fork_exec_impl", "fullyQualifiedName": "subprocess_fork_exec_impl", "decoratedName": "subprocess_fork_exec_impl", "kind": "function"}], "message": {"text": "calling 'do_fork_exec' from 'subprocess_fork_exec_impl'"}}, "kinds": ["call", "function"], "nestingLevel": 1}, {"location": {"physicalLocation": {"artifactLocation": {"uri": "./Modules/_posixsubprocess.c", "uriBaseId": "PWD"}, "region": {"startLine": 783, "startColumn": 1, "endColumn": 13}, "contextRegion": {"startLine": 783, "snippet": {"text": "do_fork_exec(char *const exec_array[],\n"}}}, "logicalLocations": [{"name": "do_fork_exec", "fullyQualifiedName": "do_fork_exec", "decoratedName": "do_fork_exec", "kind": "function"}], "message": {"text": "entry to 'do_fork_exec'"}}, "kinds": ["enter", "function"], "nestingLevel": 2}, {"location": {"physicalLocation": {"artifactLocation": {"uri": "./Modules/_posixsubprocess.c", "uriBaseId": "PWD"}, "region": {"startLine": 806, "startColumn": 8, "endColumn": 9}, "contextRegion": {"startLine": 806, "snippet": {"text": "    if (child_sigmask) {\n"}}}, "logicalLocations": [{"name": "do_fork_exec", "fullyQualifiedName": "do_fork_exec", "decoratedName": "do_fork_exec", "kind": "function"}], "message": {"text": "following 'false' branch (when 'child_sigmask' is NULL)..."}}, "kinds": ["branch", "false"], "nestingLevel": 2}, {"location": {"physicalLocation": {"artifactLocation": {"uri": "./Modules/_posixsubprocess.c", "uriBaseId": "PWD"}, "region": {"startLine": 838, "startColumn": 9, "endColumn": 12}, "contextRegion": {"startLine": 838, "snippet": {"text": "        pid = fork();\n"}}}, "logicalLocations": [{"name": "do_fork_exec", "fullyQualifiedName": "do_fork_exec", "decoratedName": "do_fork_exec", "kind": "function"}], "message": {"text": "...to here"}}, "kinds": ["branch", "false"], "nestingLevel": 2}, {"location": {"physicalLocation": {"artifactLocation": {"uri": "./Modules/_posixsubprocess.c", "uriBaseId": "PWD"}, "region": {"startLine": 841, "startColumn": 8, "endColumn": 9}, "contextRegion": {"startLine": 841, "snippet": {"text": "    if (pid != 0) {\n"}}}, "logicalLocations": [{"name": "do_fork_exec", "fullyQualifiedName": "do_fork_exec", "decoratedName": "do_fork_exec", "kind": "function"}], "message": {"text": "following 'false' branch (when 'pid == 0')..."}}, "kinds": ["branch", "false"], "nestingLevel": 2}, {"location": {"physicalLocation": {"artifactLocation": {"uri": "./Modules/_posixsubprocess.c", "uriBaseId": "PWD"}, "region": {"startLine": 851, "startColumn": 5, "endColumn": 7}, "contextRegion": {"startLine": 851, "snippet": {"text": "    if (preexec_fn != Py_None) {\n"}}}, "logicalLocations": [{"name": "do_fork_exec", "fullyQualifiedName": "do_fork_exec", "decoratedName": "do_fork_exec", "kind": "function"}], "message": {"text": "...to here"}}, "kinds": ["branch", "false"], "nestingLevel": 2}, {"location": {"physicalLocation": {"artifactLocation": {"uri": "./Modules/_posixsubprocess.c", "uriBaseId": "PWD"}, "region": {"startLine": 859, "startColumn": 5, "endLine": 866, "endColumn": 50}, "contextRegion": {"startLine": 859, "endLine": 866, "snippet": {"text": "    child_exec(exec_array, argv, envp, cwd,\n               p2cread, p2cwrite, c2pread, c2pwrite,\n               errread, errwrite, errpipe_read, errpipe_write,\n               close_fds, restore_signals, call_setsid, pgid_to_set,\n               gid, extra_group_size, extra_groups,\n               uid, child_umask, child_sigmask,\n               fds_to_keep, fds_to_keep_len,\n               preexec_fn, preexec_fn_args_tuple);\n"}}}, "logicalLocations": [{"name": "do_fork_exec", "fullyQualifiedName": "do_fork_exec", "decoratedName": "do_fork_exec", "kind": "function"}], "message": {"text": "calling 'child_exec' from 'do_fork_exec'"}}, "kinds": ["call", "function"], "nestingLevel": 2}, {"location": {"physicalLocation": {"artifactLocation": {"uri": "./Modules/_posixsubprocess.c", "uriBaseId": "PWD"}, "region": {"startLine": 574, "startColumn": 1, "endColumn": 11}, "contextRegion": {"startLine": 574, "snippet": {"text": "child_exec(char *const exec_array[],\n"}}}, "logicalLocations": [{"name": "child_exec", "fullyQualifiedName": "child_exec", "decoratedName": "child_exec", "kind": "function"}], "message": {"text": "entry to 'child_exec'"}}, "kinds": ["enter", "function"], "nestingLevel": 3}, {"location": {"physicalLocation": {"artifactLocation": {"uri": "./Modules/_posixsubprocess.c", "uriBaseId": "PWD"}, "region": {"startLine": 599, "startColumn": 8, "endColumn": 9}, "contextRegion": {"startLine": 599, "snippet": {"text": "    if (make_inheritable(fds_to_keep, fds_to_keep_len, errpipe_write) < 0)\n"}}}, "logicalLocations": [{"name": "child_exec", "fullyQualifiedName": "child_exec", "decoratedName": "child_exec", "kind": "function"}], "message": {"text": "following 'false' branch..."}}, "kinds": ["branch", "false"], "nestingLevel": 3}, {"location": {"physicalLocation": {"artifactLocation": {"uri": "./Modules/_posixsubprocess.c", "uriBaseId": "PWD"}, "region": {"startLine": 603, "startColumn": 5, "endColumn": 7}, "contextRegion": {"startLine": 603, "snippet": {"text": "    if (p2cwrite != -1)\n"}}}, "logicalLocations": [{"name": "child_exec", "fullyQualifiedName": "child_exec", "decoratedName": "child_exec", "kind": "function"}], "message": {"text": "...to here"}}, "kinds": ["branch", "false"], "nestingLevel": 3}, {"location": {"physicalLocation": {"artifactLocation": {"uri": "./Modules/_posixsubprocess.c", "uriBaseId": "PWD"}, "region": {"startLine": 603, "startColumn": 8, "endColumn": 9}, "contextRegion": {"startLine": 603, "snippet": {"text": "    if (p2cwrite != -1)\n"}}}, "logicalLocations": [{"name": "child_exec", "fullyQualifiedName": "child_exec", "decoratedName": "child_exec", "kind": "function"}], "message": {"text": "following 'false' branch (when 'p2cwrite == -1')..."}}, "kinds": ["branch", "false"], "nestingLevel": 3}, {"location": {"physicalLocation": {"artifactLocation": {"uri": "./Modules/_posixsubprocess.c", "uriBaseId": "PWD"}, "region": {"startLine": 604, "startColumn": 9, "endColumn": 10}, "contextRegion": {"startLine": 604, "snippet": {"text": "        POSIX_CALL(close(p2cwrite));\n"}}}, "logicalLocations": [{"name": "child_exec", "fullyQualifiedName": "child_exec", "decoratedName": "child_exec", "kind": "function"}], "message": {"text": "...to here"}}, "kinds": ["branch", "false"], "nestingLevel": 3}, {"location": {"physicalLocation": {"artifactLocation": {"uri": "./Modules/_posixsubprocess.c", "uriBaseId": "PWD"}, "region": {"startLine": 605, "startColumn": 8, "endColumn": 9}, "contextRegion": {"startLine": 605, "snippet": {"text": "    if (c2pread != -1)\n"}}}, "logicalLocations": [{"name": "child_exec", "fullyQualifiedName": "child_exec", "decoratedName": "child_exec", "kind": "function"}], "message": {"text": "following 'false' branch (when 'c2pread == -1')..."}}, "kinds": ["branch", "false"], "nestingLevel": 3}, {"location": {"physicalLocation": {"artifactLocation": {"uri": "./Modules/_posixsubprocess.c", "uriBaseId": "PWD"}, "region": {"startLine": 606, "startColumn": 9, "endColumn": 10}, "contextRegion": {"startLine": 606, "snippet": {"text": "        POSIX_CALL(close(c2pread));\n"}}}, "logicalLocations": [{"name": "child_exec", "fullyQualifiedName": "child_exec", "decoratedName": "child_exec", "kind": "function"}], "message": {"text": "...to here"}}, "kinds": ["branch", "false"], "nestingLevel": 3}, {"location": {"physicalLocation": {"artifactLocation": {"uri": "./Modules/_posixsubprocess.c", "uriBaseId": "PWD"}, "region": {"startLine": 607, "startColumn": 8, "endColumn": 9}, "contextRegion": {"startLine": 607, "snippet": {"text": "    if (errread != -1)\n"}}}, "logicalLocations": [{"name": "child_exec", "fullyQualifiedName": "child_exec", "decoratedName": "child_exec", "kind": "function"}], "message": {"text": "following 'false' branch (when 'errread == -1')..."}}, "kinds": ["branch", "false"], "nestingLevel": 3}, {"location": {"physicalLocation": {"artifactLocation": {"uri": "./Modules/_posixsubprocess.c", "uriBaseId": "PWD"}, "region": {"startLine": 608, "startColumn": 9, "endColumn": 10}, "contextRegion": {"startLine": 608, "snippet": {"text": "        POSIX_CALL(close(errread));\n"}}}, "logicalLocations": [{"name": "child_exec", "fullyQualifiedName": "child_exec", "decoratedName": "child_exec", "kind": "function"}], "message": {"text": "...to here"}}, "kinds": ["branch", "false"], "nestingLevel": 3}, {"location": {"physicalLocation": {"artifactLocation": {"uri": "./Modules/_posixsubprocess.c", "uriBaseId": "PWD"}, "region": {"startLine": 609, "startColumn": 5, "endColumn": 6}, "contextRegion": {"startLine": 609, "snippet": {"text": "    POSIX_CALL(close(errpipe_read));\n"}}}, "logicalLocations": [{"name": "child_exec", "fullyQualifiedName": "child_exec", "decoratedName": "child_exec", "kind": "function"}], "message": {"text": "following 'false' branch..."}}, "kinds": ["branch", "false"], "nestingLevel": 3}, {"location": {"physicalLocation": {"artifactLocation": {"uri": "./Modules/_posixsubprocess.c", "uriBaseId": "PWD"}, "region": {"startLine": 609, "startColumn": 5, "endColumn": 6}, "contextRegion": {"startLine": 609, "snippet": {"text": "    POSIX_CALL(close(errpipe_read));\n"}}}, "logicalLocations": [{"name": "child_exec", "fullyQualifiedName": "child_exec", "decoratedName": "child_exec", "kind": "function"}], "message": {"text": "...to here"}}, "kinds": ["branch", "false"], "nestingLevel": 3}, {"location": {"physicalLocation": {"artifactLocation": {"uri": "./Modules/_posixsubprocess.c", "uriBaseId": "PWD"}, "region": {"startLine": 620, "startColumn": 12, "endColumn": 42}, "contextRegion": {"startLine": 620, "snippet": {"text": "    while (errwrite == 0 || errwrite == 1) {\n"}}}, "logicalLocations": [{"name": "child_exec", "fullyQualifiedName": "child_exec", "decoratedName": "child_exec", "kind": "function"}], "message": {"text": "following 'false' branch..."}}, "kinds": ["branch", "false"], "nestingLevel": 3}, {"location": {"physicalLocation": {"artifactLocation": {"uri": "./Modules/_posixsubprocess.c", "uriBaseId": "PWD"}, "region": {"startLine": 631, "startColumn": 5, "endColumn": 7}, "contextRegion": {"startLine": 631, "snippet": {"text": "    if (p2cread == 0) {\n"}}}, "logicalLocations": [{"name": "child_exec", "fullyQualifiedName": "child_exec", "decoratedName": "child_exec", "kind": "function"}], "message": {"text": "...to here"}}, "kinds": ["branch", "false"], "nestingLevel": 3}, {"location": {"physicalLocation": {"artifactLocation": {"uri": "./Modules/_posixsubprocess.c", "uriBaseId": "PWD"}, "region": {"startLine": 632, "startColumn": 12, "endColumn": 13}, "contextRegion": {"startLine": 632, "snippet": {"text": "        if (_Py_set_inheritable_async_safe(p2cread, 1, NULL) < 0)\n"}}}, "logicalLocations": [{"name": "child_exec", "fullyQualifiedName": "child_exec", "decoratedName": "child_exec", "kind": "function"}], "message": {"text": "following 'false' branch..."}}, "kinds": ["branch", "false"], "nestingLevel": 3}, {"location": {"physicalLocation": {"artifactLocation": {"uri": "./Modules/_posixsubprocess.c", "uriBaseId": "PWD"}, "region": {"startLine": 636, "startColumn": 9, "endColumn": 10}, "contextRegion": {"startLine": 636, "snippet": {"text": "        POSIX_CALL(dup2(p2cread, 0));  /* stdin */\n"}}}, "logicalLocations": [{"name": "child_exec", "fullyQualifiedName": "child_exec", "decoratedName": "child_exec", "kind": "function"}], "message": {"text": "...to here"}}, "kinds": ["branch", "false"], "nestingLevel": 3}, {"location": {"physicalLocation": {"artifactLocation": {"uri": "./Modules/_posixsubprocess.c", "uriBaseId": "PWD"}, "region": {"startLine": 645, "startColumn": 8, "endColumn": 9}, "contextRegion": {"startLine": 645, "snippet": {"text": "    if (errwrite == 2) {\n"}}}, "logicalLocations": [{"name": "child_exec", "fullyQualifiedName": "child_exec", "decoratedName": "child_exec", "kind": "function"}], "message": {"text": "following 'false' branch (when 'errwrite != 2')..."}}, "kinds": ["branch", "false"], "nestingLevel": 3}, {"location": {"physicalLocation": {"artifactLocation": {"uri": "./Modules/_posixsubprocess.c", "uriBaseId": "PWD"}, "region": {"startLine": 649, "startColumn": 10, "endColumn": 12}, "contextRegion": {"startLine": 649, "snippet": {"text": "    else if (errwrite != -1)\n"}}}, "logicalLocations": [{"name": "child_exec", "fullyQualifiedName": "child_exec", "decoratedName": "child_exec", "kind": "function"}], "message": {"text": "...to here"}}, "kinds": ["branch", "false"], "nestingLevel": 3}, {"location": {"physicalLocation": {"artifactLocation": {"uri": "./Modules/_posixsubprocess.c", "uriBaseId": "PWD"}, "region": {"startLine": 649, "startColumn": 13, "endColumn": 14}, "contextRegion": {"startLine": 649, "snippet": {"text": "    else if (errwrite != -1)\n"}}}, "logicalLocations": [{"name": "child_exec", "fullyQualifiedName": "child_exec", "decoratedName": "child_exec", "kind": "function"}], "message": {"text": "following 'true' branch (when 'errwrite != -1')..."}}, "kinds": ["branch", "true"], "nestingLevel": 3}, {"location": {"physicalLocation": {"artifactLocation": {"uri": "./Modules/_posixsubprocess.c", "uriBaseId": "PWD"}, "region": {"startLine": 650, "startColumn": 9, "endColumn": 10}, "contextRegion": {"startLine": 650, "snippet": {"text": "        POSIX_CALL(dup2(errwrite, 2));  /* stderr */\n"}}}, "logicalLocations": [{"name": "child_exec", "fullyQualifiedName": "child_exec", "decoratedName": "child_exec", "kind": "function"}], "message": {"text": "...to here"}}, "kinds": ["branch", "true"], "nestingLevel": 3}, {"location": {"physicalLocation": {"artifactLocation": {"uri": "./Modules/_posixsubprocess.c", "uriBaseId": "PWD"}, "region": {"startLine": 650, "startColumn": 9, "endColumn": 10}, "contextRegion": {"startLine": 650, "snippet": {"text": "        POSIX_CALL(dup2(errwrite, 2));  /* stderr */\n"}}}, "logicalLocations": [{"name": "child_exec", "fullyQualifiedName": "child_exec", "decoratedName": "child_exec", "kind": "function"}], "message": {"text": "opened here"}}, "kinds": ["acquire", "resource"], "nestingLevel": 3}, {"location": {"physicalLocation": {"artifactLocation": {"uri": "./Modules/_posixsubprocess.c", "uriBaseId": "PWD"}, "region": {"startLine": 650, "startColumn": 9, "endColumn": 10}, "contextRegion": {"startLine": 650, "snippet": {"text": "        POSIX_CALL(dup2(errwrite, 2));  /* stderr */\n"}}}, "logicalLocations": [{"name": "child_exec", "fullyQualifiedName": "child_exec", "decoratedName": "child_exec", "kind": "function"}], "message": {"text": "'dup2(errwrite, 2)' leaks here; was opened at (48)"}}, "kinds": ["danger"], "nestingLevel": 3}]}]}]}]}]}
